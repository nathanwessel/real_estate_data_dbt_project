

============================== 2023-06-30 00:55:07.760590 | 536f22d4-8264-402e-a4c2-4abce3229263 ==============================
[0m00:55:07.760590 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:55:07.762044 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m00:55:07.762259 [debug] [MainThread]: Tracking: tracking
[0m00:55:07.781390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7dae0>]}
[0m00:55:08.099744 [debug] [MainThread]: Executing "git --help"
[0m00:55:08.124152 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:55:08.124813 [debug] [MainThread]: STDERR: "b''"
[0m00:55:08.133018 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:55:08.134682 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:55:08.134926 [debug] [MainThread]: On debug: select 1 as id
[0m00:55:08.135093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:09.597810 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m00:55:09.599291 [debug] [MainThread]: On debug: Close
[0m00:55:09.871994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b00d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f74eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3cdf0>]}
[0m00:55:09.872691 [debug] [MainThread]: Flushing usage events
[0m00:55:10.543730 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-30 01:00:31.340341 | 442c4066-7838-4456-8ca6-3f13e6e9590c ==============================
[0m01:00:31.340341 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:00:31.341794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m01:00:31.341963 [debug] [MainThread]: Tracking: tracking
[0m01:00:31.365134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf1a50>]}
[0m01:00:31.696790 [debug] [MainThread]: Executing "git --help"
[0m01:00:31.724374 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:00:31.725018 [debug] [MainThread]: STDERR: "b''"
[0m01:00:31.733406 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:00:31.734296 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:00:31.734457 [debug] [MainThread]: On debug: select 1 as id
[0m01:00:31.734610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:33.356484 [debug] [MainThread]: SQL status: SUCCESS 1 in 2 seconds
[0m01:00:33.357897 [debug] [MainThread]: On debug: Close
[0m01:00:33.617262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201c99c0>]}
[0m01:00:33.618384 [debug] [MainThread]: Flushing usage events
[0m01:00:34.553315 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-30 01:00:48.586209 | 1eb900d1-fd80-497a-a3c7-3f2d8447cdfb ==============================
[0m01:00:48.586209 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:00:48.587520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m01:00:48.587677 [debug] [MainThread]: Tracking: tracking
[0m01:00:48.608432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106825ae0>]}
[0m01:00:48.935880 [debug] [MainThread]: Executing "git --help"
[0m01:00:48.964755 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:00:48.965300 [debug] [MainThread]: STDERR: "b''"
[0m01:00:48.971724 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:00:48.972651 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:00:48.972835 [debug] [MainThread]: On debug: select 1 as id
[0m01:00:48.973001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:50.344631 [debug] [MainThread]: SQL status: SUCCESS 1 in 1 seconds
[0m01:00:50.346097 [debug] [MainThread]: On debug: Close
[0m01:00:50.536130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107794d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782cdf0>]}
[0m01:00:50.536784 [debug] [MainThread]: Flushing usage events
[0m01:00:51.237049 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-07-03 16:33:13.283100 | 1e1310ed-b0bf-44fe-80d7-40f3614bdcfe ==============================
[0m16:33:13.283100 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:33:13.284778 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:33:13.284957 [debug] [MainThread]: Tracking: tracking
[0m16:33:13.306170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3ca0>]}
[0m16:33:13.308134 [debug] [MainThread]: Set downloads directory='/var/folders/bc/hzhmpw894rxgr_jl9kxy34km0000gn/T/dbt-downloads-ut96ktzq'
[0m16:33:13.308693 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:33:13.696107 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:33:13.696764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:33:13.992088 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:33:13.999511 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:33:14.424095 [info ] [MainThread]:   Installed from version 1.1.1
[0m16:33:14.424422 [info ] [MainThread]:   Up to date!
[0m16:33:14.424704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e1310ed-b0bf-44fe-80d7-40f3614bdcfe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a17b0>]}
[0m16:33:14.425749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212a38e0>]}
[0m16:33:14.426218 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:56:43.981060 | cef37afd-915d-4868-bd5f-a325152b9818 ==============================
[0m16:56:43.981060 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:56:43.984562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m16:56:43.984880 [debug] [MainThread]: Tracking: tracking
[0m16:56:43.985625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109523010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109520c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109521e40>]}
[0m16:56:44.048372 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:56:44.053842 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:56:44.054121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106901e70>]}
[0m16:56:44.810167 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:56:44.819239 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:56:44.821830 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:56:44.891432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe3e80>]}
[0m16:56:44.897601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f94d00>]}
[0m16:56:44.897846 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:56:44.898069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10315fd00>]}
[0m16:56:44.899276 [info ] [MainThread]: 
[0m16:56:44.901323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:44.902234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:56:44.912393 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:56:44.912644 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:56:44.912794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:46.711110 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m16:56:46.712540 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:56:46.874021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef37afd-915d-4868-bd5f-a325152b9818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f08ca0>]}
[0m16:56:46.875158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:46.875627 [info ] [MainThread]: 
[0m16:56:46.880108 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.880365 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:56:46.880875 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m16:56:46.881056 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.891662 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.893079 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-07-03 16:56:46.881163 => 2023-07-03 16:56:46.893018
[0m16:56:46.893291 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:46.914703 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.916256 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:56:46.916698 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:56:46.916983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:47.520894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9f48-0050-3987000a41ce
[0m16:56:47.521141 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:47.521361 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-07-03 16:56:46.893408 => 2023-07-03 16:56:47.521322
[0m16:56:47.521504 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m16:56:47.688790 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:56:47.689151 [error] [Thread-1 (]: 1 of 6 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.81s]
[0m16:56:47.690663 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:56:47.691207 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.691742 [info ] [Thread-1 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:56:47.692671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m16:56:47.693068 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.698794 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.699426 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-07-03 16:56:47.693311 => 2023-07-03 16:56:47.699367
[0m16:56:47.699631 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:47.746899 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.748054 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m16:56:47.748214 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.DBT_NDW.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:56:47.748346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:48.564056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9e30-0050-3987000a0162
[0m16:56:48.564553 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:48.565252 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-07-03 16:56:47.699748 => 2023-07-03 16:56:48.565133
[0m16:56:48.565640 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:56:48.724364 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m16:56:48.725039 [error] [Thread-1 (]: 2 of 6 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 1.03s]
[0m16:56:48.725534 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m16:56:48.725959 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.726433 [info ] [Thread-1 (]: 3 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m16:56:48.728205 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m16:56:48.728463 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.733881 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.735031 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 16:56:48.728594 => 2023-07-03 16:56:48.734844
[0m16:56:48.735521 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:48.738452 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.739539 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m16:56:48.739696 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m16:56:48.739846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:49.711577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60ca
[0m16:56:49.712187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m16:56:49.712637 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 16:56:48.735804 => 2023-07-03 16:56:49.712558
[0m16:56:49.712939 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m16:56:49.861498 [debug] [Thread-1 (]: Database Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_3bb4300005e774a0ca7597884dbca3b7.sql
[0m16:56:49.862212 [error] [Thread-1 (]: 3 of 6 ERROR source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mERROR[0m in 1.14s]
[0m16:56:49.862745 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m16:56:49.863411 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.863923 [info ] [Thread-1 (]: 4 of 6 START test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m16:56:49.864945 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0'
[0m16:56:49.865406 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.873528 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.874157 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (compile): 2023-07-03 16:56:49.865660 => 2023-07-03 16:56:49.874105
[0m16:56:49.874359 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:49.878187 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.879941 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m16:56:49.880367 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID as unique_field,
    count(*) as n_records

from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is not null
group by _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:49.880711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:50.645981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60ce
[0m16:56:50.646440 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m16:56:50.646871 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (execute): 2023-07-03 16:56:49.874482 => 2023-07-03 16:56:50.646790
[0m16:56:50.647166 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: Close
[0m16:56:50.820221 [debug] [Thread-1 (]: Database Error in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m16:56:50.820909 [error] [Thread-1 (]: 4 of 6 ERROR source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mERROR[0m in 0.96s]
[0m16:56:50.821425 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m16:56:50.821880 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.822290 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:56:50.823526 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321'
[0m16:56:50.823906 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.829789 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.830345 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-07-03 16:56:50.824124 => 2023-07-03 16:56:50.830296
[0m16:56:50.830534 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:50.833249 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.834563 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m16:56:50.834776 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:50.834937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:51.478355 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9fbb-0050-3987000a60d2
[0m16:56:51.478789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:51.479211 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-07-03 16:56:50.830648 => 2023-07-03 16:56:51.479131
[0m16:56:51.479594 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m16:56:51.617199 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m16:56:51.617548 [error] [Thread-1 (]: 5 of 6 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.79s]
[0m16:56:51.617802 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m16:56:51.618039 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.618368 [info ] [Thread-1 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:56:51.618901 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:56:51.619063 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.622113 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.622610 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-07-03 16:56:51.619169 => 2023-07-03 16:56:51.622568
[0m16:56:51.622765 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:51.624697 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.625346 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:56:51.625470 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:51.625583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:52.429049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6218-0504-9f48-0050-3987000a41d2
[0m16:56:52.429462 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.429872 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-07-03 16:56:51.622865 => 2023-07-03 16:56:52.429799
[0m16:56:52.430143 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:56:52.582925 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m16:56:52.583311 [error] [Thread-1 (]: 6 of 6 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.96s]
[0m16:56:52.583594 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m16:56:52.585134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:52.586014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:52.586346 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:56:52.586824 [info ] [MainThread]: 
[0m16:56:52.587635 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m16:56:52.588083 [debug] [MainThread]: Command end result
[0m16:56:52.596898 [info ] [MainThread]: 
[0m16:56:52.597230 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m16:56:52.597418 [info ] [MainThread]: 
[0m16:56:52.597600 [error] [MainThread]: [33mDatabase Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.597822 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.598434 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.598922 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:56:52.599458 [info ] [MainThread]: 
[0m16:56:52.600091 [error] [MainThread]: [33mDatabase Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.600532 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.601008 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.601823 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m16:56:52.602495 [info ] [MainThread]: 
[0m16:56:52.603303 [error] [MainThread]: [33mDatabase Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m16:56:52.604097 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m16:56:52.604651 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m16:56:52.605142 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_3bb4300005e774a0ca7597884dbca3b7.sql
[0m16:56:52.605481 [info ] [MainThread]: 
[0m16:56:52.605680 [error] [MainThread]: [33mDatabase Error in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m16:56:52.606224 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m16:56:52.606582 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m16:56:52.606838 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m16:56:52.609261 [info ] [MainThread]: 
[0m16:56:52.609451 [error] [MainThread]: [33mDatabase Error in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.609634 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.609796 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.610054 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m16:56:52.610323 [info ] [MainThread]: 
[0m16:56:52.610512 [error] [MainThread]: [33mDatabase Error in test unique_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m16:56:52.610679 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m16:56:52.610839 [error] [MainThread]:   Object 'ANALYTICS.DBT_NDW.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m16:56:52.610996 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m16:56:52.611195 [info ] [MainThread]: 
[0m16:56:52.611388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m16:56:52.611638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f2e60>]}
[0m16:56:52.611847 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:58:00.789715 | 40a99208-a176-44f1-86e0-02369da66ebb ==============================
[0m16:58:00.789715 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:58:00.793406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:58:00.793859 [debug] [MainThread]: Tracking: tracking
[0m16:58:00.794184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108323010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108320c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108321e40>]}
[0m16:58:00.847294 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:58:00.884305 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 51 files added, 0 files changed.
[0m16:58:00.884699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m16:58:00.884890 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m16:58:00.885053 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m16:58:00.885207 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m16:58:00.885359 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m16:58:00.885511 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m16:58:00.885654 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m16:58:00.885803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m16:58:00.885947 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m16:58:00.886093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m16:58:00.886263 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m16:58:00.886405 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m16:58:00.886548 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m16:58:00.886688 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m16:58:00.886829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m16:58:00.886968 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m16:58:00.887108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m16:58:00.887245 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m16:58:00.887540 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m16:58:00.887722 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m16:58:00.887881 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m16:58:00.888031 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m16:58:00.888180 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m16:58:00.888324 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m16:58:00.888525 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m16:58:00.888673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m16:58:00.888814 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m16:58:00.888952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m16:58:00.889092 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m16:58:00.889229 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m16:58:00.889375 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m16:58:00.889514 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m16:58:00.889651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m16:58:00.889790 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m16:58:00.889930 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m16:58:00.890073 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m16:58:00.890211 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m16:58:00.890351 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m16:58:00.890493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m16:58:00.890655 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m16:58:00.890793 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m16:58:00.890932 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m16:58:00.891081 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m16:58:00.891221 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m16:58:00.891368 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m16:58:00.891507 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m16:58:00.891646 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m16:58:00.891783 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m16:58:00.891920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m16:58:00.892090 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m16:58:00.892232 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m16:58:00.892528 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/example/my_first_dbt_model.sql
[0m16:58:00.892658 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/example/my_second_dbt_model.sql
[0m16:58:01.118105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m16:58:01.126317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d6050>]}
[0m16:58:01.137004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849a410>]}
[0m16:58:01.137797 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:58:01.138403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848f7c0>]}
[0m16:58:01.139396 [info ] [MainThread]: 
[0m16:58:01.141329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:01.142410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:58:01.159958 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:58:01.160265 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:58:01.160430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:02.299525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:58:02.300817 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:58:02.449220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:58:02.454737 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:58:02.454955 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:58:02.455109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:03.342674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m16:58:03.345751 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:58:03.496440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849ad70>]}
[0m16:58:03.497688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:03.498268 [info ] [MainThread]: 
[0m16:58:03.502773 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.503142 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m16:58:03.503922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m16:58:03.504371 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.509417 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.510006 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 16:58:03.504650 => 2023-07-03 16:58:03.509874
[0m16:58:03.510337 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:03.551883 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.553464 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:03.554048 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m16:58:03.554464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:04.380997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621a-0504-9e30-0050-3987000a016e
[0m16:58:04.381253 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:04.381480 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 16:58:03.510467 => 2023-07-03 16:58:04.381439
[0m16:58:04.381624 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m16:58:04.538031 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:04.538736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40a99208-a176-44f1-86e0-02369da66ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109757430>]}
[0m16:58:04.539335 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 1.04s]
[0m16:58:04.541537 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:04.542704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:04.543111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:04.543249 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m16:58:04.543395 [info ] [MainThread]: 
[0m16:58:04.543604 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:58:04.544001 [debug] [MainThread]: Command end result
[0m16:58:04.550240 [info ] [MainThread]: 
[0m16:58:04.550597 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:04.550796 [info ] [MainThread]: 
[0m16:58:04.550980 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m16:58:04.551253 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m16:58:04.551430 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:04.551906 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:04.552304 [info ] [MainThread]: 
[0m16:58:04.552831 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:04.553444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108499e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108498e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084996c0>]}
[0m16:58:04.553862 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 16:58:25.828164 | 7508af0c-3a5d-4f9a-85f9-525dfb4c8117 ==============================
[0m16:58:25.828164 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:58:25.837006 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:58:25.838253 [debug] [MainThread]: Tracking: tracking
[0m16:58:25.838600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112125450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112125420>]}
[0m16:58:25.904816 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:58:25.949388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:25.949759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:25.950522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m16:58:25.957650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d600d0>]}
[0m16:58:25.963834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d29990>]}
[0m16:58:25.964124 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:58:25.964511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b25960>]}
[0m16:58:25.966150 [info ] [MainThread]: 
[0m16:58:25.968095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:25.969083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:58:25.981873 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:58:25.982162 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:58:25.982371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:26.962534 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m16:58:26.964824 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:58:27.151940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m16:58:27.160060 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m16:58:27.160296 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m16:58:27.160442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:28.048579 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m16:58:28.050960 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m16:58:28.204374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0efe0>]}
[0m16:58:28.205347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:28.205790 [info ] [MainThread]: 
[0m16:58:28.210351 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.211033 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m16:58:28.211678 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m16:58:28.211862 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.214008 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.214656 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 16:58:28.211980 => 2023-07-03 16:58:28.214599
[0m16:58:28.214869 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:28.245130 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.245830 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m16:58:28.245974 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m16:58:28.246095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:28.989973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621a-0504-9fbb-0050-3987000a60da
[0m16:58:28.990409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:28.990637 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 16:58:28.214995 => 2023-07-03 16:58:28.990595
[0m16:58:28.990942 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m16:58:29.139001 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:29.139667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7508af0c-3a5d-4f9a-85f9-525dfb4c8117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da09a0>]}
[0m16:58:29.140295 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.93s]
[0m16:58:29.142425 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m16:58:29.143484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:29.143832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:29.143949 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m16:58:29.144085 [info ] [MainThread]: 
[0m16:58:29.144319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m16:58:29.144623 [debug] [MainThread]: Command end result
[0m16:58:29.150670 [info ] [MainThread]: 
[0m16:58:29.150984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:29.151200 [info ] [MainThread]: 
[0m16:58:29.151362 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m16:58:29.151748 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m16:58:29.152152 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m16:58:29.152496 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m16:58:29.152849 [info ] [MainThread]: 
[0m16:58:29.153160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:29.153709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113383370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113383070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133832b0>]}
[0m16:58:29.154108 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:03:38.132868 | 41661397-7f2e-4d68-8a19-24eb6ebd8aa6 ==============================
[0m17:03:38.132868 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:03:38.141558 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:03:38.141720 [debug] [MainThread]: Tracking: tracking
[0m17:03:38.142035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dbb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119db9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119db8ee0>]}
[0m17:03:38.313091 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:03:38.378334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:38.378851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:38.379747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:03:38.390675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f900d0>]}
[0m17:03:38.406008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f59840>]}
[0m17:03:38.407092 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:03:38.407661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f59750>]}
[0m17:03:38.409295 [info ] [MainThread]: 
[0m17:03:38.411108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:38.413081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:03:38.444907 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:03:38.445446 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:03:38.445830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:39.730232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:03:39.737005 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:03:39.897451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:03:39.903508 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:03:39.903750 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:03:39.903928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:40.706955 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:03:40.713614 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:03:40.878683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2534c0>]}
[0m17:03:40.880123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:40.880493 [info ] [MainThread]: 
[0m17:03:40.885110 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.885535 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:03:40.886106 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:03:40.886600 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.895650 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.897423 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:03:40.886947 => 2023-07-03 17:03:40.897345
[0m17:03:40.898258 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:40.937085 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.938310 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:03:40.938696 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:03:40.938962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:41.755264 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad621f-0504-9e30-0050-3987000a0202
[0m17:03:41.755555 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT_NDW'
[0m17:03:41.755815 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:03:40.898439 => 2023-07-03 17:03:41.755769
[0m17:03:41.755981 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:03:41.901969 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT_NDW'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:03:41.902745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41661397-7f2e-4d68-8a19-24eb6ebd8aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2509a0>]}
[0m17:03:41.903399 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 1.02s]
[0m17:03:41.905836 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:03:41.907592 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:41.908423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:41.908759 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:03:41.909066 [info ] [MainThread]: 
[0m17:03:41.909588 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m17:03:41.910155 [debug] [MainThread]: Command end result
[0m17:03:41.921470 [info ] [MainThread]: 
[0m17:03:41.921826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:41.922024 [info ] [MainThread]: 
[0m17:03:41.922209 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m17:03:41.922850 [error] [MainThread]:   003001 (42501): SQL access control error:
[0m17:03:41.923310 [error] [MainThread]:   Insufficient privileges to operate on schema 'DBT_NDW'
[0m17:03:41.923708 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:03:41.924162 [info ] [MainThread]: 
[0m17:03:41.924624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:41.925073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cf340>]}
[0m17:03:41.925627 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:07:13.214092 | 4380fdad-d61b-40b3-8c2b-9749098bcc2f ==============================
[0m17:07:13.214092 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:07:13.218894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:07:13.219070 [debug] [MainThread]: Tracking: tracking
[0m17:07:13.219359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b20ee0>]}
[0m17:07:13.281147 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:07:13.327065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:13.327310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:13.327715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:07:13.335101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077680d0>]}
[0m17:07:13.346606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772d840>]}
[0m17:07:13.346973 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:07:13.347218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772d750>]}
[0m17:07:13.348408 [info ] [MainThread]: 
[0m17:07:13.349913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:13.350689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:07:13.369385 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:07:13.369687 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:07:13.369869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:14.442544 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:07:14.445089 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:07:14.597443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:07:14.602654 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:07:14.602861 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:07:14.603007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:15.516796 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:07:15.519179 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:07:15.673227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ab4c0>]}
[0m17:07:15.674251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:15.674693 [info ] [MainThread]: 
[0m17:07:15.679123 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.679675 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:07:15.680253 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:07:15.680439 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.683336 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.684497 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:07:15.680561 => 2023-07-03 17:07:15.684437
[0m17:07:15.684706 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:15.711572 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.712371 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:07:15.712530 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:07:15.712668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:16.431036 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6223-0504-9f86-0050-3987000a51f2
[0m17:07:16.431331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m17:07:16.431593 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:07:15.684827 => 2023-07-03 17:07:16.431546
[0m17:07:16.431758 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:07:16.576181 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:07:16.576880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4380fdad-d61b-40b3-8c2b-9749098bcc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a89a0>]}
[0m17:07:16.577511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.90s]
[0m17:07:16.579502 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:07:16.581461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:16.582266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:16.582563 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:07:16.582907 [info ] [MainThread]: 
[0m17:07:16.583307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m17:07:16.583795 [debug] [MainThread]: Command end result
[0m17:07:16.592850 [info ] [MainThread]: 
[0m17:07:16.593189 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:16.593451 [info ] [MainThread]: 
[0m17:07:16.593667 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m17:07:16.594054 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m17:07:16.594246 [error] [MainThread]:   Database 'RAW' does not exist or not authorized.
[0m17:07:16.594420 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m17:07:16.594662 [info ] [MainThread]: 
[0m17:07:16.594998 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:07:16.595268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d872b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d87130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d874f0>]}
[0m17:07:16.595481 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:19:04.214811 | 0c9c63f1-8fce-42ff-b66e-762b3aa303c7 ==============================
[0m17:19:04.214811 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:04.218998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:04.219207 [debug] [MainThread]: Tracking: tracking
[0m17:19:04.219492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a027010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a025e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a024310>]}
[0m17:19:04.293398 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:04.329461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:04.329719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:04.330170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:19:04.338750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac500d0>]}
[0m17:19:04.349019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac157e0>]}
[0m17:19:04.349310 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:04.349518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac156f0>]}
[0m17:19:04.351401 [info ] [MainThread]: 
[0m17:19:04.352882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:04.353602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:19:04.366554 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:19:04.366896 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:19:04.367083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:05.497044 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:19:05.500559 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:19:05.649453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:19:05.656270 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:19:05.656511 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:19:05.656659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:06.401222 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m17:19:06.403676 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:19:06.569112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abfee30>]}
[0m17:19:06.570136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:06.570538 [info ] [MainThread]: 
[0m17:19:06.573645 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.573973 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:19:06.574980 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:19:06.575370 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.577488 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.578279 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:19:06.575502 => 2023-07-03 17:19:06.578221
[0m17:19:06.578603 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:06.606170 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.607189 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:19:06.607368 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:19:06.607513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:07.658051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:19:07.679948 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:19:06.578904 => 2023-07-03 17:19:07.679896
[0m17:19:07.680238 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:19:07.818268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c9c63f1-8fce-42ff-b66e-762b3aa303c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac949a0>]}
[0m17:19:07.819038 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.24s]
[0m17:19:07.821462 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:07.822921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:07.823707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:07.823987 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:19:07.824267 [info ] [MainThread]: 
[0m17:19:07.824654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m17:19:07.825172 [debug] [MainThread]: Command end result
[0m17:19:07.833327 [info ] [MainThread]: 
[0m17:19:07.833935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:07.834297 [info ] [MainThread]: 
[0m17:19:07.834637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:07.835082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b36bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3689a0>]}
[0m17:19:07.835479 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:19:39.374157 | 94463f9d-8c20-441e-83a5-23a581be0c0f ==============================
[0m17:19:39.374157 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:39.377541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:19:39.377721 [debug] [MainThread]: Tracking: tracking
[0m17:19:39.378043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb8f10>]}
[0m17:19:39.519453 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:39.595736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:39.596526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:39.598384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:19:39.615307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d900d0>]}
[0m17:19:39.628158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59b40>]}
[0m17:19:39.628510 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:39.628754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59780>]}
[0m17:19:39.630069 [info ] [MainThread]: 
[0m17:19:39.632966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:39.635682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:19:39.663546 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:19:39.663885 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:19:39.664069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:40.908418 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:19:40.911326 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:19:41.058049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:19:41.072324 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:19:41.072692 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:19:41.072892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:41.790528 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:19:41.793062 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:19:41.934765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94463f9d-8c20-441e-83a5-23a581be0c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705b4f0>]}
[0m17:19:41.936051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:41.936568 [info ] [MainThread]: 
[0m17:19:41.940832 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.941150 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:19:41.941703 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:19:41.941927 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.953899 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.954859 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:19:41.942066 => 2023-07-03 17:19:41.954795
[0m17:19:41.955077 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:41.973539 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.974532 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:19:41.974701 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:19:41.974860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:43.589819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m17:19:43.606074 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:19:41.955216 => 2023-07-03 17:19:43.606003
[0m17:19:43.606365 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:19:43.737505 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.80s]
[0m17:19:43.739861 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:19:43.740414 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.740837 [info ] [Thread-1 (]: 2 of 3 START test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:19:43.741364 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0'
[0m17:19:43.741528 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.748603 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.749220 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (compile): 2023-07-03 17:19:43.741637 => 2023-07-03 17:19:43.749168
[0m17:19:43.749502 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:43.752982 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.754231 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"
[0m17:19:43.754589 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID as unique_field,
    count(*) as n_records

from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is not null
group by _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
having count(*) > 1



      
    ) dbt_internal_test
[0m17:19:43.754842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:45.583024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m17:19:45.586300 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0 (execute): 2023-07-03 17:19:43.749853 => 2023-07-03 17:19:45.586199
[0m17:19:45.586684 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0: Close
[0m17:19:45.732613 [error] [Thread-1 (]: 2 of 3 FAIL 513 source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[31mFAIL 513[0m in 1.99s]
[0m17:19:45.733530 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0
[0m17:19:45.734876 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:45.735404 [info ] [Thread-1 (]: 3 of 3 SKIP relation DBT_NDW.stg_property_sale_listings ........................ [[33mSKIP[0m]
[0m17:19:45.736070 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:19:45.738490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:45.738929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:45.739063 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.f304a60ff0' was properly closed.
[0m17:19:45.739220 [info ] [MainThread]: 
[0m17:19:45.739427 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m17:19:45.740259 [debug] [MainThread]: Command end result
[0m17:19:45.751343 [info ] [MainThread]: 
[0m17:19:45.752214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:45.752561 [info ] [MainThread]: 
[0m17:19:45.752761 [error] [MainThread]: [31mFailure in test source_unique_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m17:19:45.752933 [error] [MainThread]:   Got 513 results, configured to fail if != 0
[0m17:19:45.753089 [info ] [MainThread]: 
[0m17:19:45.753582 [info ] [MainThread]:   compiled Code at target/compiled/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_unique_realty_mole_prop_63c5f22da60d46a3fd1151a3a7ff960c.sql
[0m17:19:45.753757 [info ] [MainThread]: 
[0m17:19:45.753915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:19:45.754160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d59720>]}
[0m17:19:45.754353 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:22:20.831125 | d4a52cb6-f733-4eb7-9609-6fbbfd1860b1 ==============================
[0m17:22:20.831125 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:22:20.836924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:22:20.837182 [debug] [MainThread]: Tracking: tracking
[0m17:22:20.837493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32b6a0>]}
[0m17:22:20.911093 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:22:20.942836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:22:20.943188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:22:20.943374 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:22:20.943535 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:22:20.943685 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:22:20.943831 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:22:20.943978 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:22:20.944120 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:22:20.944262 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:22:20.944404 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:22:20.944543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:22:20.944686 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:22:20.944825 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:22:20.944965 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:22:20.945109 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:22:20.945247 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:22:20.945387 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:22:20.945528 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:22:20.945670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:22:20.945811 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:22:20.945952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:22:20.946091 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:22:20.946230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:22:20.946366 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:22:20.946501 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:22:20.946642 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:22:20.946780 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:22:20.946918 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:22:20.947054 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:22:20.947191 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:22:20.947326 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:22:20.947462 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:22:20.947601 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:22:20.947738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:22:20.947877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:22:20.948014 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:22:20.948152 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:22:20.948287 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:22:20.948426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:22:20.948562 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:22:20.948734 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:22:20.948872 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:22:20.949008 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:22:20.949145 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:22:20.949280 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:22:20.949418 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:22:20.949557 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:22:20.949691 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:22:20.949826 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:22:20.950270 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:22:20.950738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:22:20.951011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:22:21.156556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:22:21.161221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d5540>]}
[0m17:22:21.169185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d098430>]}
[0m17:22:21.169624 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:22:21.170099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a3e20>]}
[0m17:22:21.171855 [info ] [MainThread]: 
[0m17:22:21.173344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:21.174083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:22:21.187103 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:22:21.187394 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:22:21.187566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:22.338685 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:22:22.340831 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:22:22.490276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:22:22.498261 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:22:22.498530 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:22:22.498697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:23.514793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:22:23.517371 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:22:23.706543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a52cb6-f733-4eb7-9609-6fbbfd1860b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bdf30>]}
[0m17:22:23.707697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:23.708199 [info ] [MainThread]: 
[0m17:22:23.712898 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.713482 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT  [RUN]
[0m17:22:23.714144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb'
[0m17:22:23.714590 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.726119 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.726695 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb (compile): 2023-07-03 17:22:23.714826 => 2023-07-03 17:22:23.726644
[0m17:22:23.726889 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:23.753234 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.754159 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"
[0m17:22:23.754321 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMMITED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMMITED_AT is null



      
    ) dbt_internal_test
[0m17:22:23.754461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:24.592615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6232-0504-9fbb-0050-3987000a627a
[0m17:22:24.593072 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier '_AIRBYTE_EMMITED_AT'
[0m17:22:24.593487 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb (execute): 2023-07-03 17:22:23.727011 => 2023-07-03 17:22:24.593409
[0m17:22:24.593960 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb: Close
[0m17:22:24.751209 [debug] [Thread-1 (]: Database Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT (models/staging/property_sale_listings/src_property_sale_listings.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier '_AIRBYTE_EMMITED_AT'
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_7f1cbe6b133c3b2fd5884310674af600.sql
[0m17:22:24.751868 [error] [Thread-1 (]: 1 of 3 ERROR source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT  [[31mERROR[0m in 1.04s]
[0m17:22:24.753967 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT.d5b724a6eb
[0m17:22:24.754339 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.754610 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:22:24.755363 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:22:24.755808 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.763401 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.764434 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:22:24.756047 => 2023-07-03 17:22:24.764360
[0m17:22:24.764669 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:24.766908 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.767818 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:22:24.768194 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:22:24.768461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:25.474368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:22:25.484035 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:22:24.764811 => 2023-07-03 17:22:25.483962
[0m17:22:25.484318 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:22:25.637273 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.88s]
[0m17:22:25.638071 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:22:25.639029 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:22:25.639476 [info ] [Thread-1 (]: 3 of 3 SKIP relation DBT_NDW.stg_property_sale_listings ........................ [[33mSKIP[0m]
[0m17:22:25.639984 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:22:25.641439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:25.642933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:25.643320 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46' was properly closed.
[0m17:22:25.643519 [info ] [MainThread]: 
[0m17:22:25.643727 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m17:22:25.644023 [debug] [MainThread]: Command end result
[0m17:22:25.652421 [info ] [MainThread]: 
[0m17:22:25.662462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:25.662671 [info ] [MainThread]: 
[0m17:22:25.662855 [error] [MainThread]: [33mDatabase Error in test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMMITED_AT (models/staging/property_sale_listings/src_property_sale_listings.yml)[0m
[0m17:22:25.663022 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 7
[0m17:22:25.663175 [error] [MainThread]:   invalid identifier '_AIRBYTE_EMMITED_AT'
[0m17:22:25.663563 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/src_property_sale_listings.yml/source_not_null_realty_mole_pr_7f1cbe6b133c3b2fd5884310674af600.sql
[0m17:22:25.663745 [info ] [MainThread]: 
[0m17:22:25.663915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:22:25.664147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80e020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80e500>]}
[0m17:22:25.664349 [debug] [MainThread]: Flushing usage events


============================== 2023-07-03 17:23:26.608106 | ecc4f082-20fd-48e4-8513-0500a332816f ==============================
[0m17:23:26.608106 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:23:26.613960 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m17:23:26.614221 [debug] [MainThread]: Tracking: tracking
[0m17:23:26.616625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106622fb0>]}
[0m17:23:26.691335 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:23:26.739897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:23:26.740268 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:23:26.740456 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:23:26.741004 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:23:26.741195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:23:26.741354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:23:26.741506 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:23:26.741658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:23:26.741803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:23:26.741950 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:23:26.742091 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:23:26.742230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:23:26.742370 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:23:26.742512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:23:26.742651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:23:26.742788 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:23:26.742926 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:23:26.743060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:23:26.743195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:23:26.743327 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:23:26.743461 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:23:26.743595 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:23:26.743729 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:23:26.743863 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:23:26.743995 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:23:26.744127 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:23:26.744264 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:23:26.744397 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:23:26.744531 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:23:26.744667 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:23:26.744802 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:23:26.744936 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:23:26.745073 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:23:26.745210 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:23:26.745349 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:23:26.745483 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:23:26.745616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:23:26.745750 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:23:26.745884 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:23:26.746018 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:23:26.746185 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:23:26.746322 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:23:26.746455 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:23:26.746593 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:23:26.746727 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:23:26.746865 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:23:26.747143 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:23:26.747340 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:23:26.747493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:23:26.747634 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:23:26.747794 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:23:26.747929 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:23:27.055774 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:23:27.063728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d8be0>]}
[0m17:23:27.074928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a3e20>]}
[0m17:23:27.075275 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:23:27.075505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff70>]}
[0m17:23:27.076515 [info ] [MainThread]: 
[0m17:23:27.078107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:27.079078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:23:27.094720 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:23:27.095260 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:23:27.095579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:28.479721 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m17:23:28.481859 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:23:28.685482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:23:28.692200 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:23:28.692471 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:23:28.692632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:29.503937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:23:29.506358 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:23:29.647687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba950>]}
[0m17:23:29.648713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:29.649031 [info ] [MainThread]: 
[0m17:23:29.654135 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.654690 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m17:23:29.655390 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m17:23:29.655596 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.669915 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.673954 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-03 17:23:29.655723 => 2023-07-03 17:23:29.673893
[0m17:23:29.674154 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:29.690505 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.691411 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:23:29.691566 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m17:23:29.691701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:30.938290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:30.948328 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-03 17:23:29.674265 => 2023-07-03 17:23:30.948262
[0m17:23:30.948575 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m17:23:31.092769 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.44s]
[0m17:23:31.095619 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:23:31.096712 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.097157 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:23:31.097731 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:23:31.097924 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.101983 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.102519 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-03 17:23:31.098045 => 2023-07-03 17:23:31.102472
[0m17:23:31.102695 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:31.104652 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.105364 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:23:31.105500 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:23:31.105629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:31.863852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:31.866695 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-03 17:23:31.102810 => 2023-07-03 17:23:31.866599
[0m17:23:31.867087 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:23:32.025300 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.93s]
[0m17:23:32.026125 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:23:32.027895 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.028676 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:23:32.029595 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:23:32.029835 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.031995 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.032853 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-03 17:23:32.029953 => 2023-07-03 17:23:32.032800
[0m17:23:32.033037 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:32.056259 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.057636 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:23:32.058904 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select * from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:23:32.059236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:32.981414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:23:33.002888 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-03 17:23:32.033148 => 2023-07-03 17:23:33.002839
[0m17:23:33.003161 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:23:33.156905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc4f082-20fd-48e4-8513-0500a332816f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fcf6d0>]}
[0m17:23:33.157638 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.13s]
[0m17:23:33.158161 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:23:33.159708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:33.160511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:33.160833 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m17:23:33.161120 [info ] [MainThread]: 
[0m17:23:33.161526 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m17:23:33.162301 [debug] [MainThread]: Command end result
[0m17:23:33.169592 [info ] [MainThread]: 
[0m17:23:33.169899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:33.170445 [info ] [MainThread]: 
[0m17:23:33.170656 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:23:33.171217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ba950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f8a6b0>]}
[0m17:23:33.171463 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:19:06.610158 | 35b78dd9-2590-4c6d-b557-e3134f0381f3 ==============================
[0m21:19:06.610158 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:19:06.615531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:19:06.615700 [debug] [MainThread]: Tracking: tracking
[0m21:19:06.615931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8f10>]}
[0m21:19:06.690454 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:19:06.741675 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 51 files added, 0 files changed.
[0m21:19:06.741960 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:19:06.742089 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:19:06.742196 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:19:06.742294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:19:06.742389 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:19:06.742485 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:19:06.742579 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:19:06.742830 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:19:06.743190 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:19:06.743325 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:19:06.743431 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:19:06.743530 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:19:06.743628 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:19:06.743722 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:19:06.743814 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:19:06.743905 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:19:06.743993 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:19:06.744083 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:19:06.744173 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:19:06.744261 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:19:06.744351 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:19:06.744438 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:19:06.744526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:19:06.744616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:19:06.744705 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:19:06.744798 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:19:06.744890 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:19:06.744979 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:19:06.745069 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:19:06.745156 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:19:06.745244 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:19:06.745334 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:19:06.745428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:19:06.745520 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:19:06.745614 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:19:06.745703 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:19:06.745793 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:19:06.745883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:19:06.745997 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:19:06.746088 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:19:06.746178 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:19:06.746268 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:19:06.746358 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:19:06.746715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:19:06.747136 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:19:06.747294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:19:06.747411 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:19:06.747515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:19:06.747616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:19:06.747717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:19:06.747938 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:19:06.748206 [debug] [MainThread]: Partial parsing: deleted file: real_estate_dbt_project://models/staging/property_sale_listings/old_stg_property_sale_listings.sql
[0m21:19:06.908473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:19:06.912128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139359f0>]}
[0m21:19:06.921491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f32b0>]}
[0m21:19:06.921770 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:19:06.921934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112c640>]}
[0m21:19:06.923159 [info ] [MainThread]: 
[0m21:19:06.926016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:06.927232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:19:06.938658 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:19:06.939039 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:19:06.939159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:08.753944 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:19:08.756186 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:19:08.931407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:19:08.939193 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:19:08.939410 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:19:08.939726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:09.996206 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:19:09.998706 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:19:10.166201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f3730>]}
[0m21:19:10.167345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:10.167805 [info ] [MainThread]: 
[0m21:19:10.171013 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.171267 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:19:10.172215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:19:10.172653 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.183935 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.186289 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:19:10.173308 => 2023-07-05 21:19:10.186229
[0m21:19:10.186453 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:10.199348 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.200015 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:10.200128 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:19:10.200231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:12.081442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m21:19:12.093664 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:19:10.186546 => 2023-07-05 21:19:12.093542
[0m21:19:12.094151 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:19:12.275366 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 2.10s]
[0m21:19:12.278026 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:12.278649 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.279244 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:19:12.280123 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:19:12.280315 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.284239 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.284924 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:19:12.280410 => 2023-07-05 21:19:12.284879
[0m21:19:12.285075 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:12.286612 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.287164 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:12.287267 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:19:12.287360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:13.228526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:13.229929 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:19:12.285164 => 2023-07-05 21:19:13.229892
[0m21:19:13.230078 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:19:13.435044 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m21:19:13.435519 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:13.436076 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.436292 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:19:13.436652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:19:13.436894 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.440646 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.441706 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:19:13.437239 => 2023-07-05 21:19:13.441576
[0m21:19:13.442220 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:13.457750 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.458488 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:13.458595 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id
listeddate as listed_date,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
formattedaddress as formatted_address,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:19:13.458689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:14.243633 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad6e5f-0504-a156-0050-3987000a9006
[0m21:19:14.243882 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 11 unexpected 'as'.
[0m21:19:14.244073 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:19:13.442351 => 2023-07-05 21:19:14.244037
[0m21:19:14.244195 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:19:14.416421 [debug] [Thread-1 (]: Database Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 11 unexpected 'as'.
  compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:19:14.417063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b78dd9-2590-4c6d-b557-e3134f0381f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4ceb0>]}
[0m21:19:14.417612 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model DBT_NDW.stg_property_sale_listings ........ [[31mERROR[0m in 0.98s]
[0m21:19:14.418125 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:14.419377 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:14.419739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:14.419843 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:19:14.419965 [info ] [MainThread]: 
[0m21:19:14.420124 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m21:19:14.420358 [debug] [MainThread]: Command end result
[0m21:19:14.425290 [info ] [MainThread]: 
[0m21:19:14.425531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:19:14.425671 [info ] [MainThread]: 
[0m21:19:14.425803 [error] [MainThread]: [33mDatabase Error in model stg_property_sale_listings (models/staging/property_sale_listings/stg_property_sale_listings.sql)[0m
[0m21:19:14.425986 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m21:19:14.426122 [error] [MainThread]:   syntax error line 18 at position 11 unexpected 'as'.
[0m21:19:14.426318 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:19:14.426507 [info ] [MainThread]: 
[0m21:19:14.426802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:19:14.427062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f1570>]}
[0m21:19:14.427219 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:19:33.839641 | ec8101ab-8a58-426d-93d3-16b99d435619 ==============================
[0m21:19:33.839641 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:19:33.843748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m21:19:33.844029 [debug] [MainThread]: Tracking: tracking
[0m21:19:33.844583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c27730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c246a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c25e10>]}
[0m21:19:33.897961 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:19:33.929910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:19:33.930199 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:19:33.930374 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:19:33.930537 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:19:33.930670 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:19:33.930816 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:19:33.930946 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:19:33.931062 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:19:33.931203 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:19:33.931321 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:19:33.931435 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:19:33.931572 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:19:33.931686 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:19:33.931798 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:19:33.931905 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:19:33.932008 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:19:33.932144 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:19:33.932252 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:19:33.932356 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:19:33.932462 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:19:33.932568 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:19:33.932673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:19:33.932779 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:19:33.932886 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:19:33.933019 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:19:33.933125 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:19:33.933231 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:19:33.933335 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:19:33.933441 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:19:33.933545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:19:33.933652 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:19:33.933758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:19:33.933862 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:19:33.933967 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:19:33.934074 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:19:33.934180 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:19:33.934282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:19:33.934383 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:19:33.934485 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:19:33.934664 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:19:33.934896 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:19:33.935058 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:19:33.935182 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:19:33.935301 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:19:33.935417 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:19:33.935536 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:19:33.935653 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:19:33.935770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:19:33.935885 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:19:33.936005 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:19:33.936125 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:19:33.936237 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:19:34.136560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:19:34.142303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd56c0>]}
[0m21:19:34.152256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8dea0>]}
[0m21:19:34.152558 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:19:34.152738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111216d70>]}
[0m21:19:34.153463 [info ] [MainThread]: 
[0m21:19:34.155111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:34.156013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:19:34.165802 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:19:34.166090 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:19:34.166222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:35.289512 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:19:35.291202 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:19:35.458790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:19:35.463075 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:19:35.463261 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:19:35.463386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:36.439175 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:19:36.441493 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:19:36.611660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8ead0>]}
[0m21:19:36.612490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:36.612732 [info ] [MainThread]: 
[0m21:19:36.615372 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.615601 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:19:36.616282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:19:36.616721 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.629928 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.630560 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:19:36.616964 => 2023-07-05 21:19:36.630513
[0m21:19:36.630725 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:36.650750 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.651532 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:19:36.651674 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:19:36.651788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.751022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:37.759429 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:19:36.630834 => 2023-07-05 21:19:37.759375
[0m21:19:37.759647 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:19:37.932460 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.32s]
[0m21:19:37.935283 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:19:37.936008 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.936486 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:19:37.937445 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:19:37.937924 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.942644 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.943140 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:19:37.938033 => 2023-07-05 21:19:37.943099
[0m21:19:37.943285 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:37.944944 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.945698 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:19:37.945820 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:19:37.945927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:38.601846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:38.604822 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:19:37.943375 => 2023-07-05 21:19:38.604711
[0m21:19:38.605264 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:19:38.754196 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.82s]
[0m21:19:38.754936 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:19:38.755876 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.756450 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:19:38.757427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:19:38.757808 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.761261 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.761751 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:19:38.758043 => 2023-07-05 21:19:38.761705
[0m21:19:38.761901 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:38.781010 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.781816 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:19:38.781937 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id,
listeddate as listed_date,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
formattedaddress as formatted_address,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:19:38.782049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:39.896688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:19:39.913825 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:19:38.761993 => 2023-07-05 21:19:39.913785
[0m21:19:39.914036 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:19:40.068396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec8101ab-8a58-426d-93d3-16b99d435619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc88e0>]}
[0m21:19:40.069176 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.31s]
[0m21:19:40.069744 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:19:40.071449 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:40.072539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:40.072845 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:19:40.073152 [info ] [MainThread]: 
[0m21:19:40.073577 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m21:19:40.074307 [debug] [MainThread]: Command end result
[0m21:19:40.080600 [info ] [MainThread]: 
[0m21:19:40.081091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:40.081336 [info ] [MainThread]: 
[0m21:19:40.081544 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:19:40.081994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120280850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bcb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b7b20>]}
[0m21:19:40.082193 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:23:46.934336 | 76d393f4-46a1-44de-8f59-0e3773bb7dbb ==============================
[0m21:23:46.934336 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:23:46.939004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:23:46.939196 [debug] [MainThread]: Tracking: tracking
[0m21:23:46.939495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110423790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110420ee0>]}
[0m21:23:47.003783 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:23:47.033416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:23:47.033735 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:23:47.033914 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:23:47.034059 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:23:47.034195 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:23:47.034416 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:23:47.034589 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:23:47.034737 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:23:47.034880 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:23:47.035016 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:23:47.035151 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:23:47.035282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:23:47.035413 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:23:47.035545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:23:47.035674 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:23:47.035803 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:23:47.036011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:23:47.036140 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:23:47.036265 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:23:47.036390 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:23:47.036515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:23:47.036638 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:23:47.036770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:23:47.036906 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:23:47.037033 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:23:47.037155 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:23:47.037279 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:23:47.037402 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:23:47.037526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:23:47.037649 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:23:47.037777 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:23:47.037901 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:23:47.038026 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:23:47.038148 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:23:47.038277 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:23:47.038404 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:23:47.038526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:23:47.038651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:23:47.038776 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:23:47.038897 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:23:47.039052 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:23:47.039177 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:23:47.039303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:23:47.039424 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:23:47.039545 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:23:47.039673 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:23:47.039800 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:23:47.039927 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:23:47.040052 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:23:47.040192 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:23:47.040318 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:23:47.040446 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:23:47.264897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:23:47.271910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cccd0>]}
[0m21:23:47.280272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056c190>]}
[0m21:23:47.280590 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:23:47.280801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16d40>]}
[0m21:23:47.282308 [info ] [MainThread]: 
[0m21:23:47.285000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:47.286157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:23:47.299898 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:23:47.300199 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:23:47.300382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:48.915649 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:23:48.917746 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:23:49.106201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:23:49.114339 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:23:49.114597 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:23:49.114747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:50.212277 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:23:50.214597 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:23:50.395023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16d40>]}
[0m21:23:50.396208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:50.397121 [info ] [MainThread]: 
[0m21:23:50.399997 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.400213 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:23:50.400681 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:23:50.400854 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.413756 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.415186 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:23:50.400975 => 2023-07-05 21:23:50.415044
[0m21:23:50.415463 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:50.435277 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.436342 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:23:50.436512 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:23:50.436651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:51.609090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:51.618243 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:23:50.415586 => 2023-07-05 21:23:51.618180
[0m21:23:51.618499 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:23:51.885309 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.48s]
[0m21:23:51.887611 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:23:51.888211 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.888711 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:23:51.889699 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:23:51.890089 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.898166 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.898860 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:23:51.890322 => 2023-07-05 21:23:51.898809
[0m21:23:51.899079 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:51.902963 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.903826 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:23:51.903974 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:23:51.904096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:52.990237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:52.995975 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:23:51.899243 => 2023-07-05 21:23:52.995860
[0m21:23:52.996446 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:23:53.290836 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.40s]
[0m21:23:53.291586 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:23:53.292795 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.293520 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:23:53.294699 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:23:53.295194 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.298405 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.299322 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:23:53.295445 => 2023-07-05 21:23:53.299247
[0m21:23:53.299547 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:53.322561 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.323647 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:23:53.323798 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done
select _airbyte_emitted_at as iteration_date,
id,
listeddate as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:23:53.323926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:54.823323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:23:54.844704 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:23:53.299669 => 2023-07-05 21:23:54.844610
[0m21:23:54.845138 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:23:55.116585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d393f4-46a1-44de-8f59-0e3773bb7dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d3610>]}
[0m21:23:55.117440 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.82s]
[0m21:23:55.118087 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:23:55.119989 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:55.120436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:55.120571 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:23:55.120726 [info ] [MainThread]: 
[0m21:23:55.120925 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m21:23:55.121225 [debug] [MainThread]: Command end result
[0m21:23:55.128010 [info ] [MainThread]: 
[0m21:23:55.128335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:55.128571 [info ] [MainThread]: 
[0m21:23:55.128772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:23:55.129731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8820>]}
[0m21:23:55.130187 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:29:11.200912 | 1aef08df-5d7d-4a50-8d05-ef997fae4145 ==============================
[0m21:29:11.200912 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:29:11.204427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:29:11.204595 [debug] [MainThread]: Tracking: tracking
[0m21:29:11.204902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c123730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c121de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c122e90>]}
[0m21:29:11.275487 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:29:11.303919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:29:11.304251 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:29:11.304422 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:29:11.304565 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:29:11.304699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:29:11.304828 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:29:11.304963 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:29:11.305095 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:29:11.305228 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:29:11.305361 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:29:11.305491 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:29:11.305620 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:29:11.305745 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:29:11.305872 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:29:11.305996 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:29:11.306133 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:29:11.306258 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:29:11.306383 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:29:11.306512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:29:11.306635 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:29:11.306758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:29:11.306892 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:29:11.307018 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:29:11.307145 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:29:11.307278 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:29:11.307407 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:29:11.307528 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:29:11.307657 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:29:11.307777 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:29:11.307898 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:29:11.308022 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:29:11.308143 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:29:11.308265 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:29:11.308385 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:29:11.308509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:29:11.308628 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:29:11.308758 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:29:11.308888 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:29:11.309010 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:29:11.309132 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:29:11.309303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:29:11.309441 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:29:11.309580 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:29:11.309718 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:29:11.309948 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:29:11.310134 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:29:11.310292 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:29:11.310439 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:29:11.310585 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:29:11.310733 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:29:11.310880 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:29:11.311024 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:29:11.531083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:29:11.537993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ccca0>]}
[0m21:29:11.544905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26c040>]}
[0m21:29:11.545220 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:29:11.545486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26c070>]}
[0m21:29:11.546444 [info ] [MainThread]: 
[0m21:29:11.547985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:11.548682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:29:11.561836 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:29:11.562121 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:29:11.562289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:12.652974 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:29:12.655184 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:29:12.804862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:29:12.812502 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:29:12.812750 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:29:12.812899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:14.087075 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:29:14.089534 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:29:14.256606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c247e50>]}
[0m21:29:14.257740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:14.258374 [info ] [MainThread]: 
[0m21:29:14.261594 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.261852 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:29:14.262658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:29:14.262910 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.272501 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.273592 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:29:14.263032 => 2023-07-05 21:29:14.273540
[0m21:29:14.273792 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:14.304194 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.306142 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:29:14.306545 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:29:14.306709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:15.459219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:15.469677 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:29:14.273919 => 2023-07-05 21:29:15.469610
[0m21:29:15.469961 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:29:15.657149 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.39s]
[0m21:29:15.659802 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:29:15.660438 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.660800 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:29:15.662054 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:29:15.662514 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.671007 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.672131 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:29:15.662763 => 2023-07-05 21:29:15.672017
[0m21:29:15.672690 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:15.675765 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.676942 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:29:15.677086 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:29:15.677214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:16.341353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:16.344380 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:29:15.672929 => 2023-07-05 21:29:16.344267
[0m21:29:16.344819 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:29:16.509169 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.85s]
[0m21:29:16.509903 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:29:16.510969 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.511537 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:29:16.512483 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:29:16.512831 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.515711 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.516811 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:29:16.513514 => 2023-07-05 21:29:16.516754
[0m21:29:16.517020 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:16.545409 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.546608 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:29:16.546788 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple stream lit app that shows the end table
-- then add it to linkedin
-- then call it done

-- format me as a date
select date(_airbyte_emitted_at) as iteration_date,
id,
-- format me as a date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:29:16.546933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:17.479526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:29:17.498221 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:29:16.517137 => 2023-07-05 21:29:17.498179
[0m21:29:17.498448 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:29:17.660930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aef08df-5d7d-4a50-8d05-ef997fae4145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23190>]}
[0m21:29:17.661681 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.15s]
[0m21:29:17.662218 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:29:17.663940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:17.664758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:17.665049 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:29:17.665356 [info ] [MainThread]: 
[0m21:29:17.665769 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m21:29:17.666442 [debug] [MainThread]: Command end result
[0m21:29:17.673770 [info ] [MainThread]: 
[0m21:29:17.674139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:17.674359 [info ] [MainThread]: 
[0m21:29:17.674556 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:29:17.674833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca23dc0>]}
[0m21:29:17.675048 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 21:31:48.087382 | d2f232d7-3e17-4ac5-82a9-08ee04173d88 ==============================
[0m21:31:48.087382 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:31:48.092860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:31:48.093378 [debug] [MainThread]: Tracking: tracking
[0m21:31:48.094888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112622fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112621e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112621e40>]}
[0m21:31:48.166340 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:31:48.213035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m21:31:48.213389 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:31:48.213578 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:31:48.213740 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:31:48.213907 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:31:48.214058 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:31:48.214212 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:31:48.214356 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:31:48.214501 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:31:48.214645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:31:48.214790 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:31:48.214937 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:31:48.215079 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:31:48.215225 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:31:48.215366 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:31:48.215509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:31:48.215651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:31:48.215792 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:31:48.215931 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:31:48.216074 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:31:48.216216 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:31:48.216353 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:31:48.216490 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:31:48.216627 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:31:48.216765 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:31:48.216901 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:31:48.217040 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:31:48.217177 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:31:48.217314 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:31:48.217451 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:31:48.217596 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:31:48.217736 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:31:48.217876 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:31:48.218012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:31:48.218153 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:31:48.218292 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:31:48.218428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:31:48.218564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:31:48.218695 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:31:48.218829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:31:48.218994 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:31:48.219130 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:31:48.219269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:31:48.219406 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:31:48.219540 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:31:48.219678 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:31:48.219813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:31:48.219949 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:31:48.220086 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:31:48.220222 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:31:48.220363 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:31:48.220505 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:31:48.497126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:31:48.504204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d4c40>]}
[0m21:31:48.512475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276c130>]}
[0m21:31:48.512802 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:31:48.513037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a7f40>]}
[0m21:31:48.513984 [info ] [MainThread]: 
[0m21:31:48.515458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:48.516378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:31:48.528801 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:31:48.529097 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:31:48.529264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:49.856678 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m21:31:49.858533 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:31:50.030687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:31:50.039593 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:31:50.039887 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:31:50.040057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:51.046413 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:31:51.050042 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:31:51.266351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112797f70>]}
[0m21:31:51.268203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:51.268565 [info ] [MainThread]: 
[0m21:31:51.272843 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.273176 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:31:51.273812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:31:51.274009 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.294344 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.297615 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 21:31:51.274133 => 2023-07-05 21:31:51.297471
[0m21:31:51.299111 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:51.323403 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.324249 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:31:51.324393 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:31:51.324527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:52.068135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:52.074180 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 21:31:51.299502 => 2023-07-05 21:31:52.074119
[0m21:31:52.074422 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:31:52.236252 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.96s]
[0m21:31:52.237719 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:31:52.237989 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.238151 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:31:52.239214 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:31:52.239594 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.245774 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.246358 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 21:31:52.239842 => 2023-07-05 21:31:52.246306
[0m21:31:52.246555 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:52.249395 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.250291 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:31:52.250446 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:31:52.250591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:53.174288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:53.175927 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 21:31:52.246668 => 2023-07-05 21:31:53.175878
[0m21:31:53.176119 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:31:53.339893 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.10s]
[0m21:31:53.340843 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:31:53.341902 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.342547 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:31:53.343548 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:31:53.343966 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.348077 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.349124 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 21:31:53.344218 => 2023-07-05 21:31:53.349075
[0m21:31:53.349326 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:53.370037 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.371089 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:31:53.371254 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:31:53.371397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:54.367193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:31:54.386122 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 21:31:53.349453 => 2023-07-05 21:31:54.386074
[0m21:31:54.386379 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:31:54.574228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f232d7-3e17-4ac5-82a9-08ee04173d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d1f6d0>]}
[0m21:31:54.574651 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.23s]
[0m21:31:54.574928 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:31:54.576353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:54.576720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:54.576837 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m21:31:54.576975 [info ] [MainThread]: 
[0m21:31:54.578136 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m21:31:54.578558 [debug] [MainThread]: Command end result
[0m21:31:54.584547 [info ] [MainThread]: 
[0m21:31:54.584918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:54.585099 [info ] [MainThread]: 
[0m21:31:54.585270 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:31:54.585545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cdcd30>]}
[0m21:31:54.585731 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:15:47.267049 | eb19b6ee-4b39-4a20-b6c4-64f530823858 ==============================
[0m22:15:47.267049 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:15:47.271667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:15:47.271870 [debug] [MainThread]: Tracking: tracking
[0m22:15:47.272173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c27790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c24580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c25e10>]}
[0m22:15:47.337950 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:15:47.377135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:47.377576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:47.378361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:15:47.387819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfc0d0>]}
[0m22:15:47.399295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1990>]}
[0m22:15:47.399644 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:15:47.400054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d31e70>]}
[0m22:15:47.401602 [info ] [MainThread]: 
[0m22:15:47.403297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:47.404938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:15:47.417964 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:15:47.418243 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:15:47.418412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:48.717482 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:15:48.719733 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:15:48.900398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:15:48.906231 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:15:48.906462 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:15:48.906613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:49.740039 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:15:49.742437 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:15:49.915632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107267400>]}
[0m22:15:49.916677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:49.917110 [info ] [MainThread]: 
[0m22:15:49.920968 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.921232 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:15:49.921702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:15:49.921855 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.932160 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.932830 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:15:49.921962 => 2023-07-05 22:15:49.932779
[0m22:15:49.933022 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:49.948376 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.949195 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:15:49.949328 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:15:49.949450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:51.133777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:51.146151 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:15:49.933137 => 2023-07-05 22:15:51.146079
[0m22:15:51.146419 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:15:51.340799 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m22:15:51.343478 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:15:51.344117 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.344568 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:15:51.345572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:15:51.346238 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.350126 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.350670 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:15:51.346384 => 2023-07-05 22:15:51.350621
[0m22:15:51.350850 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:51.355462 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.356331 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:15:51.356477 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:15:51.356610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:52.323616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:52.326621 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:15:51.350963 => 2023-07-05 22:15:52.326503
[0m22:15:52.327082 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:15:52.511515 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.17s]
[0m22:15:52.512242 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:15:52.513130 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.513809 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:15:52.514811 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:15:52.515202 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.517617 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.518541 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:15:52.515479 => 2023-07-05 22:15:52.518493
[0m22:15:52.518725 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:52.536456 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.537979 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:15:52.538492 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:15:52.539071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:53.490458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:15:53.509108 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:15:52.518828 => 2023-07-05 22:15:53.509057
[0m22:15:53.509372 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:15:53.659148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb19b6ee-4b39-4a20-b6c4-64f530823858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c31600>]}
[0m22:15:53.659585 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.14s]
[0m22:15:53.659888 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:15:53.661669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:53.662452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:53.662731 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:15:53.663038 [info ] [MainThread]: 
[0m22:15:53.663484 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m22:15:53.664241 [debug] [MainThread]: Command end result
[0m22:15:53.675673 [info ] [MainThread]: 
[0m22:15:53.676322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:53.676895 [info ] [MainThread]: 
[0m22:15:53.677558 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:53.677931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c22a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c20400>]}
[0m22:15:53.678154 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:16:51.969141 | 31d87165-1ef8-4cce-9a96-d824b1841a5a ==============================
[0m22:16:51.969141 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:16:51.973506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:16:51.973717 [debug] [MainThread]: Tracking: tracking
[0m22:16:51.973992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21e40>]}
[0m22:16:52.038066 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:16:52.078896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:52.079140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:52.079533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:16:52.086160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fc0d0>]}
[0m22:16:52.093662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1b40>]}
[0m22:16:52.093977 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:16:52.094205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1780>]}
[0m22:16:52.095096 [info ] [MainThread]: 
[0m22:16:52.096542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:52.097243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:16:52.110755 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:16:52.111032 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:16:52.111200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:53.338789 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:16:53.339924 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:16:53.722286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:16:53.728952 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:16:53.729211 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:16:53.729363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:54.839736 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:16:54.841471 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:16:55.068378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2fb0>]}
[0m22:16:55.069381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:55.069848 [info ] [MainThread]: 
[0m22:16:55.074751 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.075015 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:16:55.075505 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:16:55.075700 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.084756 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.085443 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:16:55.075824 => 2023-07-05 22:16:55.085393
[0m22:16:55.085640 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:55.101754 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.102604 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:16:55.102766 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:16:55.102907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:55.867156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:55.874739 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:16:55.085759 => 2023-07-05 22:16:55.874681
[0m22:16:55.874985 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:16:56.054215 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.98s]
[0m22:16:56.056828 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:16:56.057411 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.057844 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:16:56.058796 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:16:56.059026 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.063220 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.063687 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:16:56.059146 => 2023-07-05 22:16:56.063641
[0m22:16:56.063933 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:56.067772 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.068590 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:16:56.068743 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:16:56.068884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:57.083609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:57.086702 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:16:56.064080 => 2023-07-05 22:16:57.086586
[0m22:16:57.087151 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:16:57.235768 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.18s]
[0m22:16:57.236182 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:16:57.236953 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.237288 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:16:57.237736 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:16:57.237891 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.239999 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.240746 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:16:57.237996 => 2023-07-05 22:16:57.240703
[0m22:16:57.240924 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:57.262288 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.263980 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:16:57.264481 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in, and convert the timestamp to a date
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
select date(_airbyte_emitted_at) as iteration_date,
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:16:57.264672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:58.178784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:16:58.198859 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:16:57.241032 => 2023-07-05 22:16:58.198807
[0m22:16:58.199191 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:16:58.347929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31d87165-1ef8-4cce-9a96-d824b1841a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107031f30>]}
[0m22:16:58.348814 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.11s]
[0m22:16:58.349353 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:16:58.350764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:58.351214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:58.351359 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:16:58.351519 [info ] [MainThread]: 
[0m22:16:58.351730 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m22:16:58.352166 [debug] [MainThread]: Command end result
[0m22:16:58.360403 [info ] [MainThread]: 
[0m22:16:58.360997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:58.361230 [info ] [MainThread]: 
[0m22:16:58.361509 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:16:58.361811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070299f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070283d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107028760>]}
[0m22:16:58.362044 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:23:28.198606 | 470901d3-11a9-4887-bada-6ddab2dffc22 ==============================
[0m22:23:28.198606 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:23:28.204064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:23:28.204514 [debug] [MainThread]: Tracking: tracking
[0m22:23:28.205054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f20a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f236a0>]}
[0m22:23:28.282026 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:23:28.324455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:23:28.324817 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:23:28.325012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:23:28.325175 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:23:28.325328 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:23:28.325482 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:23:28.325636 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:23:28.325785 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:23:28.325938 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:23:28.326086 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:23:28.326234 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:23:28.326381 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:23:28.326883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:23:28.327283 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:23:28.327492 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:23:28.327654 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:23:28.328072 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:23:28.328428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:23:28.328830 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:23:28.329226 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:23:28.329539 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:23:28.329849 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:23:28.330158 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:23:28.330448 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:23:28.330741 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:23:28.331092 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:23:28.331452 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:23:28.331760 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:23:28.332057 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:23:28.332353 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:23:28.332636 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:23:28.332976 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:23:28.333381 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:23:28.333720 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:23:28.333924 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:23:28.334080 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:23:28.334230 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:23:28.334379 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:23:28.334524 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:23:28.334668 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:23:28.334859 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:23:28.335001 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:23:28.335146 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:23:28.335288 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:23:28.335433 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:23:28.335572 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:23:28.335715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:23:28.335856 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:23:28.335998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:23:28.336226 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:23:28.336418 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:23:28.336642 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:23:28.641556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:23:28.649835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b98c40>]}
[0m22:23:28.663833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34130>]}
[0m22:23:28.664197 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:23:28.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fbe20>]}
[0m22:23:28.665845 [info ] [MainThread]: 
[0m22:23:28.667272 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:28.667955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:23:28.686845 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:23:28.687355 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:23:28.687672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:29.918088 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:23:29.919532 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:23:30.076857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:23:30.082909 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:23:30.083176 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:23:30.083335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:31.038552 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:23:31.041032 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:23:31.199431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc5930>]}
[0m22:23:31.200487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:31.200940 [info ] [MainThread]: 
[0m22:23:31.205696 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.206245 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:23:31.207428 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:23:31.207678 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.221615 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.222352 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:23:31.207824 => 2023-07-05 22:23:31.222297
[0m22:23:31.222576 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:31.246779 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.247735 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:23:31.247902 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:23:31.248046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:31.933979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:31.944044 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:23:31.222708 => 2023-07-05 22:23:31.943975
[0m22:23:31.944319 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:23:32.075402 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.87s]
[0m22:23:32.078099 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:23:32.078774 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.079248 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:23:32.080219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:23:32.080703 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.087699 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.088672 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:23:32.080964 => 2023-07-05 22:23:32.088524
[0m22:23:32.089115 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:32.091468 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.092339 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:23:32.092503 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:23:32.092919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:32.952327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:32.955385 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:23:32.089432 => 2023-07-05 22:23:32.955262
[0m22:23:32.955852 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:23:33.113667 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.03s]
[0m22:23:33.114449 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:23:33.115422 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.116033 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:23:33.117036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:23:33.117427 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.123819 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.125198 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:23:33.119316 => 2023-07-05 22:23:33.125118
[0m22:23:33.125460 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:33.151344 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.152685 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:23:33.152884 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
select date(_airbyte_emitted_at)||'_'||id as home_iteration_id,
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:23:33.153031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:33.991438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:23:34.010423 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:23:33.125591 => 2023-07-05 22:23:34.010372
[0m22:23:34.010792 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:23:34.232888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '470901d3-11a9-4887-bada-6ddab2dffc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d36d0>]}
[0m22:23:34.233329 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.12s]
[0m22:23:34.233627 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:23:34.234739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:34.235151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:34.235295 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:23:34.235416 [debug] [MainThread]: Connection 'list_ANALYTICS_DBT_NDW' was properly closed.
[0m22:23:34.235580 [info ] [MainThread]: 
[0m22:23:34.235788 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m22:23:34.237243 [debug] [MainThread]: Command end result
[0m22:23:34.244063 [info ] [MainThread]: 
[0m22:23:34.244908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:34.245155 [info ] [MainThread]: 
[0m22:23:34.245344 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:23:34.245953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dc790>]}
[0m22:23:34.246512 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:24:49.416358 | d05119ea-21c6-4a27-b8f4-6bd2491bde19 ==============================
[0m22:24:49.416358 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:24:49.421810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:24:49.422043 [debug] [MainThread]: Tracking: tracking
[0m22:24:49.422352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd21e40>]}
[0m22:24:49.494665 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:24:49.524576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:24:49.524930 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:24:49.525116 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:24:49.525274 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:24:49.525426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:24:49.525574 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:24:49.525725 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:24:49.525870 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:24:49.526015 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:24:49.526155 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:24:49.526304 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:24:49.526445 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:24:49.526586 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:24:49.526727 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:24:49.526869 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:24:49.527009 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:24:49.527153 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:24:49.527294 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:24:49.527429 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:24:49.527564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:24:49.527698 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:24:49.527832 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:24:49.527967 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:24:49.528102 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:24:49.528236 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:24:49.528704 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:24:49.529026 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:24:49.529178 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:24:49.529323 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:24:49.529459 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:24:49.529601 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:24:49.529738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:24:49.529877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:24:49.530015 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:24:49.530157 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:24:49.530298 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:24:49.530436 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:24:49.530575 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:24:49.530712 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:24:49.530849 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:24:49.531017 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:24:49.531154 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:24:49.531288 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:24:49.531422 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:24:49.531559 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:24:49.531691 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:24:49.531824 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:24:49.531959 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:24:49.532093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:24:49.532231 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:24:49.532367 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:24:49.532500 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:24:49.748349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:24:49.753799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ced1690>]}
[0m22:24:49.761444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce9f850>]}
[0m22:24:49.761868 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:24:49.762130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118801e70>]}
[0m22:24:49.763072 [info ] [MainThread]: 
[0m22:24:49.765678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:49.766942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:24:49.778752 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:24:49.779065 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:24:49.779261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:50.861763 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:24:50.863878 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:24:51.027626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:24:51.035176 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:24:51.035450 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:24:51.035596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:52.012136 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:24:52.014484 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:24:52.165255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccb9f00>]}
[0m22:24:52.166477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:52.166792 [info ] [MainThread]: 
[0m22:24:52.170970 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.171462 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:24:52.172767 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:24:52.173554 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.189115 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.189825 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:24:52.173863 => 2023-07-05 22:24:52.189775
[0m22:24:52.190076 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:52.209647 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.210519 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:24:52.210686 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:24:52.210844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:52.962132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:52.969497 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:24:52.190224 => 2023-07-05 22:24:52.969432
[0m22:24:52.969762 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:24:53.113810 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.94s]
[0m22:24:53.116297 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:24:53.116785 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.117868 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:24:53.118612 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:24:53.118785 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.124040 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.124887 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:24:53.118891 => 2023-07-05 22:24:53.124804
[0m22:24:53.125259 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:53.127427 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.128262 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:24:53.128409 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:24:53.128542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:54.094983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:54.097302 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:24:53.125520 => 2023-07-05 22:24:54.097201
[0m22:24:54.097694 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:24:54.275961 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m22:24:54.276363 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:24:54.277337 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.277956 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:24:54.278772 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:24:54.279188 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.283752 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.285468 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:24:54.279403 => 2023-07-05 22:24:54.285342
[0m22:24:54.285753 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:54.308379 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.309733 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:24:54.309927 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- START BACK HERE: change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

-- convert timestamp to date
select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:24:54.310073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:55.265010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:55.283715 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:24:54.285883 => 2023-07-05 22:24:55.283662
[0m22:24:55.283972 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:24:55.460852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05119ea-21c6-4a27-b8f4-6bd2491bde19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62bdf0>]}
[0m22:24:55.461817 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.18s]
[0m22:24:55.462414 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:24:55.464145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:55.465440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:55.465916 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:24:55.466317 [info ] [MainThread]: 
[0m22:24:55.466802 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m22:24:55.467480 [debug] [MainThread]: Command end result
[0m22:24:55.475401 [info ] [MainThread]: 
[0m22:24:55.475743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:55.475947 [info ] [MainThread]: 
[0m22:24:55.476202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:24:55.476510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db80820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccc9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62ba60>]}
[0m22:24:55.476747 [debug] [MainThread]: Flushing usage events


============================== 2023-07-05 22:27:14.018378 | 52a2e6b1-5b6b-4394-b535-7d508acead3e ==============================
[0m22:27:14.018378 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:14.021655 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m22:27:14.021867 [debug] [MainThread]: Tracking: tracking
[0m22:27:14.022161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105923730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105921de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105922e90>]}
[0m22:27:14.081417 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:27:14.116045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:27:14.116399 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:27:14.116593 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:27:14.116755 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:27:14.116908 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:27:14.117061 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:27:14.117210 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:27:14.117354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:27:14.117492 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:27:14.117632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:27:14.117813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:27:14.117956 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:27:14.118101 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:27:14.118247 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:27:14.118393 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:27:14.118534 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:27:14.118677 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:27:14.118816 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:27:14.118957 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:27:14.119093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:27:14.119235 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:27:14.119373 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:27:14.119515 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:27:14.119658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:27:14.119801 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:27:14.119945 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:27:14.120085 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:27:14.120227 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:27:14.120371 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:27:14.120514 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:27:14.120660 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:27:14.120804 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:27:14.120946 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:27:14.121085 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:27:14.121228 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:27:14.121367 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:27:14.121509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:27:14.121736 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:27:14.121920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:27:14.122079 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:27:14.122263 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:27:14.122410 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:27:14.122554 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:27:14.122702 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:27:14.122843 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:27:14.122987 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:27:14.123130 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:27:14.123269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:27:14.123409 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:27:14.123552 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:27:14.123694 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:27:14.123834 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:27:14.335784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m22:27:14.340509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0ca0>]}
[0m22:27:14.349389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6c040>]}
[0m22:27:14.349681 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m22:27:14.349904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa2da0>]}
[0m22:27:14.350867 [info ] [MainThread]: 
[0m22:27:14.352184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:14.352795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:27:14.368470 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:27:14.368757 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:27:14.368938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:15.410129 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m22:27:15.412394 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:27:15.569593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m22:27:15.576975 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m22:27:15.577209 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m22:27:15.577357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:16.556035 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m22:27:16.558518 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m22:27:16.711241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a47ee0>]}
[0m22:27:16.712382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:16.712839 [info ] [MainThread]: 
[0m22:27:16.720070 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.720390 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m22:27:16.721211 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m22:27:16.721657 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.735149 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.736092 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-05 22:27:16.721901 => 2023-07-05 22:27:16.736025
[0m22:27:16.736328 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:16.756185 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.757191 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m22:27:16.757374 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m22:27:16.757523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:17.445736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:17.451303 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-05 22:27:16.736461 => 2023-07-05 22:27:17.451247
[0m22:27:17.451534 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m22:27:17.610072 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.89s]
[0m22:27:17.611542 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m22:27:17.611829 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.612077 [info ] [Thread-1 (]: 2 of 3 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m22:27:17.612594 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m22:27:17.612778 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.618940 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.619560 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-05 22:27:17.612901 => 2023-07-05 22:27:17.619491
[0m22:27:17.619762 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:17.622717 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.623572 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m22:27:17.623730 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m22:27:17.623867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:18.381325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:18.384426 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-05 22:27:17.619883 => 2023-07-05 22:27:18.384303
[0m22:27:18.384896 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m22:27:18.553886 [info ] [Thread-1 (]: 2 of 3 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.94s]
[0m22:27:18.554620 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m22:27:18.555551 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.556133 [info ] [Thread-1 (]: 3 of 3 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m22:27:18.557099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m22:27:18.557454 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.560185 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.561017 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-05 22:27:18.557669 => 2023-07-05 22:27:18.560959
[0m22:27:18.561218 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:18.586827 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.587923 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m22:27:18.588098 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m22:27:18.588240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:19.406142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m22:27:19.423727 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-05 22:27:18.561335 => 2023-07-05 22:27:19.423679
[0m22:27:19.423979 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m22:27:19.589169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a2e6b1-5b6b-4394-b535-7d508acead3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd36d0>]}
[0m22:27:19.589992 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.03s]
[0m22:27:19.590739 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m22:27:19.593083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:19.593582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:19.593736 [debug] [MainThread]: Connection 'model.real_estate_dbt_project.stg_property_sale_listings' was properly closed.
[0m22:27:19.593904 [info ] [MainThread]: 
[0m22:27:19.594131 [info ] [MainThread]: Finished running 2 tests, 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m22:27:19.594464 [debug] [MainThread]: Command end result
[0m22:27:19.600267 [info ] [MainThread]: 
[0m22:27:19.600582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:27:19.600772 [info ] [MainThread]: 
[0m22:27:19.600950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:27:19.601192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f90e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106731690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067305b0>]}
[0m22:27:19.601400 [debug] [MainThread]: Flushing usage events


============================== 2023-07-06 21:49:35.952474 | b7fd027f-825f-403e-9bf3-3d71db7d3350 ==============================
[0m21:49:35.952474 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:49:35.959362 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:49:35.959553 [debug] [MainThread]: Tracking: tracking
[0m21:49:35.960010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d237c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d21e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d20f10>]}
[0m21:49:36.027056 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:49:36.064006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 1 files changed.
[0m21:49:36.064358 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:49:36.064543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:49:36.064699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:49:36.064850 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:49:36.064998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:49:36.065142 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:49:36.065283 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:49:36.065426 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:49:36.065564 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:49:36.065702 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:49:36.065836 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:49:36.065971 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:49:36.066108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:49:36.066245 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:49:36.066378 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:49:36.066517 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:49:36.066651 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:49:36.066786 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:49:36.066920 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:49:36.067054 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:49:36.067188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:49:36.067320 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:49:36.067454 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:49:36.067585 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:49:36.067717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:49:36.067852 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:49:36.067986 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:49:36.068121 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:49:36.068250 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:49:36.068401 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:49:36.068543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:49:36.068676 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:49:36.068807 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:49:36.068939 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:49:36.069070 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:49:36.069204 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:49:36.069338 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:49:36.069504 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:49:36.069641 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:49:36.069776 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:49:36.069910 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:49:36.070120 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:49:36.070255 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:49:36.070390 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:49:36.070523 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:49:36.070671 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:49:36.070809 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:49:36.070943 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:49:36.071076 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:49:36.071208 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:49:36.071354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:49:36.071640 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sales_listings.yml
[0m21:49:36.305353 [debug] [MainThread]: 1699: static parser successfully parsed staging/property_sale_listings/stg_property_sale_listings.sql
[0m21:49:36.325204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115946410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159816c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159820e0>]}
[0m21:49:36.325512 [debug] [MainThread]: Flushing usage events
[0m21:49:36.906632 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/property_sale_listings/stg_property_sales_listings.yml @ models: {'name': 'stg_property_sale_listings', 'description': 'Staged property sale listings data for single-family homes in a particular zipcode.', 'columns': [{'name': 'addr_iteration_date_id', 'description': 'Concatenation of Address (in ID form) with the Iteration Date when the data was fetched.', 'tests': ['unique', 'not_null']}, {'name': 'iteration_date', 'description': 'Date (with timestamp removed) when the data was inserted into the raw schema from the API.', 'tests': ['not_null']}, {'name': 'id', 'description': 'Address of the home in id form (Ex. 123-Muffin-Man-Ln,-Seattle,-WA-12345)'}, {'name': 'listed_date', 'description': 'Date the home was listed.'}, {'name': 'formatted_address', 'description': 'Properly-formatted address of the home (Ex. 123 Muffin Man Ln, Seattle, WA 12345)'}, {'name': 'num_bathrooms', 'description': 'Number of bathrooms in the home (can be a decimal for half-baths).'}, {'name': 'num_bedrooms', 'description': 'Number of bedrooms in the home.'}, {'name': None}], 'original_file_path': 'models/staging/property_sale_listings/stg_property_sales_listings.yml', 'yaml_key': 'models', 'package_name': 'real_estate_dbt_project'} - at path ['columns'][7]['name']: None is not of type 'string'


============================== 2023-07-06 21:49:52.187154 | 7bd0c8c9-c329-4de4-ab62-b185755ad903 ==============================
[0m21:49:52.187154 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:49:52.190535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m21:49:52.190716 [debug] [MainThread]: Tracking: tracking
[0m21:49:52.191032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109743f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3cb670>]}
[0m21:49:52.275093 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:49:52.311431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 1 files changed.
[0m21:49:52.311841 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m21:49:52.312039 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m21:49:52.312205 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m21:49:52.312357 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m21:49:52.312512 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m21:49:52.312658 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m21:49:52.312805 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m21:49:52.312953 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m21:49:52.313095 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m21:49:52.313235 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m21:49:52.313376 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m21:49:52.313543 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m21:49:52.313694 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m21:49:52.313842 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m21:49:52.313980 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m21:49:52.314118 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m21:49:52.314257 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m21:49:52.314397 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m21:49:52.314536 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m21:49:52.314674 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m21:49:52.314813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m21:49:52.314948 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m21:49:52.315084 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m21:49:52.315218 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m21:49:52.315355 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m21:49:52.315493 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m21:49:52.315632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m21:49:52.315770 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m21:49:52.315908 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m21:49:52.316053 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m21:49:52.316189 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m21:49:52.316330 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m21:49:52.316465 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m21:49:52.316602 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m21:49:52.316738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m21:49:52.316874 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m21:49:52.317011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m21:49:52.317289 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m21:49:52.317434 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m21:49:52.317570 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m21:49:52.317707 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m21:49:52.317847 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m21:49:52.317990 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m21:49:52.318132 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m21:49:52.318269 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m21:49:52.318399 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m21:49:52.318522 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m21:49:52.318645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m21:49:52.318768 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m21:49:52.318891 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m21:49:52.319012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m21:49:52.319217 [debug] [MainThread]: Partial parsing: updated file: real_estate_dbt_project://models/staging/property_sale_listings/stg_property_sales_listings.yml
[0m21:49:52.534043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m21:49:52.540210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ab820>]}
[0m21:49:52.553641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b9900>]}
[0m21:49:52.554005 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:49:52.554242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bacb0>]}
[0m21:49:52.555295 [info ] [MainThread]: 
[0m21:49:52.556721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:52.557496 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:49:52.571717 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:49:52.572166 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:49:52.572695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:54.134964 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m21:49:54.137205 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:49:54.307596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m21:49:54.315797 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m21:49:54.316058 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m21:49:54.316211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:55.221001 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m21:49:55.223366 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m21:49:55.369458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d174220>]}
[0m21:49:55.370045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:55.370303 [info ] [MainThread]: 
[0m21:49:55.373475 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.373687 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m21:49:55.374113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m21:49:55.374259 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.387209 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.389023 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-06 21:49:55.374368 => 2023-07-06 21:49:55.388723
[0m21:49:55.389378 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:55.415480 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.416603 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m21:49:55.416782 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m21:49:55.416922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:56.627439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:56.638785 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-06 21:49:55.389502 => 2023-07-06 21:49:56.638629
[0m21:49:56.639259 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m21:49:56.789850 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m21:49:56.791604 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m21:49:56.792189 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.792577 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m21:49:56.793340 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m21:49:56.793523 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.797106 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.797976 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-06 21:49:56.793636 => 2023-07-06 21:49:56.797862
[0m21:49:56.798417 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:56.801148 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.802385 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m21:49:56.802803 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m21:49:56.803150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:57.531651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:57.534713 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-06 21:49:56.798671 => 2023-07-06 21:49:57.534601
[0m21:49:57.535273 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m21:49:57.689350 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.90s]
[0m21:49:57.690109 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m21:49:57.691072 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.691641 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m21:49:57.692589 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m21:49:57.693009 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.697328 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.698305 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-06 21:49:57.693291 => 2023-07-06 21:49:57.698135
[0m21:49:57.699172 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:57.721853 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.723585 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m21:49:57.723985 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m21:49:57.724278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:58.635828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:58.653960 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-06 21:49:57.699313 => 2023-07-06 21:49:58.653916
[0m21:49:58.654223 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m21:49:58.813125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bd0c8c9-c329-4de4-ab62-b185755ad903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f75d1b0>]}
[0m21:49:58.813954 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.12s]
[0m21:49:58.816037 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m21:49:58.817590 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.818263 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m21:49:58.819326 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m21:49:58.819784 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.823596 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.824297 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-06 21:49:58.819942 => 2023-07-06 21:49:58.824167
[0m21:49:58.824657 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:49:58.827950 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.829594 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m21:49:58.829948 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m21:49:58.830101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.884548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:49:59.887445 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-06 21:49:58.824775 => 2023-07-06 21:49:59.887344
[0m21:49:59.887866 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m21:50:00.049331 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.23s]
[0m21:50:00.050136 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m21:50:00.050631 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.051753 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m21:50:00.053260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m21:50:00.053545 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.060407 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.062223 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-06 21:50:00.053663 => 2023-07-06 21:50:00.062124
[0m21:50:00.062682 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:00.069532 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.071034 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m21:50:00.071261 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m21:50:00.071428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:01.326803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:50:01.355021 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-06 21:50:00.062988 => 2023-07-06 21:50:01.354526
[0m21:50:01.356068 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m21:50:01.510835 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.46s]
[0m21:50:01.516691 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m21:50:01.517602 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.518529 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m21:50:01.519864 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m21:50:01.520533 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.534257 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.535526 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-06 21:50:01.520809 => 2023-07-06 21:50:01.535447
[0m21:50:01.535806 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:01.544364 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.549841 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m21:50:01.550156 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:01.550356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:02.530937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m21:50:02.563247 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-06 21:50:01.536042 => 2023-07-06 21:50:02.560236
[0m21:50:02.565083 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m21:50:02.732524 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.21s]
[0m21:50:02.737302 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m21:50:02.744795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:02.745353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:02.745486 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m21:50:02.745686 [info ] [MainThread]: 
[0m21:50:02.746831 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 10.19 seconds (10.19s).
[0m21:50:02.748031 [debug] [MainThread]: Command end result
[0m21:50:02.776194 [info ] [MainThread]: 
[0m21:50:02.777109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:02.777348 [info ] [MainThread]: 
[0m21:50:02.777534 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:50:02.778274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f90370>]}
[0m21:50:02.779119 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 17:50:46.904491 | 49418761-6523-437c-915d-fd892087b08d ==============================
[0m17:50:46.904491 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:50:46.908428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m17:50:46.908849 [debug] [MainThread]: Tracking: tracking
[0m17:50:46.909354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b21e40>]}
[0m17:50:46.978838 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:50:47.009367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m17:50:47.010384 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m17:50:47.010900 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m17:50:47.011117 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m17:50:47.011262 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m17:50:47.011391 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m17:50:47.011517 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m17:50:47.011639 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m17:50:47.011761 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m17:50:47.011883 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m17:50:47.011998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m17:50:47.012115 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m17:50:47.012281 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m17:50:47.012781 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m17:50:47.013449 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m17:50:47.013668 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m17:50:47.013807 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m17:50:47.013929 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m17:50:47.014050 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m17:50:47.014500 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m17:50:47.015159 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m17:50:47.015539 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m17:50:47.016049 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m17:50:47.016549 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m17:50:47.016710 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m17:50:47.016914 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m17:50:47.017060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m17:50:47.017188 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:50:47.017309 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m17:50:47.017427 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m17:50:47.017549 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m17:50:47.017665 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m17:50:47.017779 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m17:50:47.017968 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m17:50:47.018093 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m17:50:47.018214 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m17:50:47.018330 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m17:50:47.018721 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m17:50:47.018902 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m17:50:47.019467 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m17:50:47.020157 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m17:50:47.020282 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m17:50:47.020403 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m17:50:47.020516 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m17:50:47.020632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m17:50:47.020762 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m17:50:47.020876 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m17:50:47.020989 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m17:50:47.021103 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m17:50:47.021361 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m17:50:47.021488 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m17:50:47.021605 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m17:50:47.220509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m17:50:47.225493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce15a0>]}
[0m17:50:47.233496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abb220>]}
[0m17:50:47.233786 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:50:47.233983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a32890>]}
[0m17:50:47.235000 [info ] [MainThread]: 
[0m17:50:47.237501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:47.239199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m17:50:47.252956 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m17:50:47.253207 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m17:50:47.253356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:49.682473 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m17:50:49.684803 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m17:50:50.016077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m17:50:50.020745 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m17:50:50.020945 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m17:50:50.021088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:50.835570 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m17:50:50.838025 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m17:50:51.072107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f4cd0>]}
[0m17:50:51.073253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:51.073720 [info ] [MainThread]: 
[0m17:50:51.077554 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.077870 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m17:50:51.078307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m17:50:51.078716 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.088897 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.089981 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 17:50:51.078817 => 2023-07-08 17:50:51.089916
[0m17:50:51.090196 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:51.105795 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.106949 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m17:50:51.107322 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m17:50:51.107728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:52.553988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:52.566219 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 17:50:51.090310 => 2023-07-08 17:50:52.566164
[0m17:50:52.566453 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m17:50:52.786749 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.71s]
[0m17:50:52.789413 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m17:50:52.790103 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.790570 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m17:50:52.791584 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m17:50:52.792134 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.801145 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.802136 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 17:50:52.792379 => 2023-07-08 17:50:52.802081
[0m17:50:52.802343 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:52.805723 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.806569 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m17:50:52.806734 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m17:50:52.806856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:53.735893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:53.738776 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 17:50:52.802596 => 2023-07-08 17:50:53.738671
[0m17:50:53.739181 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m17:50:53.991564 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.20s]
[0m17:50:53.992296 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m17:50:53.993308 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:53.993911 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m17:50:53.994853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m17:50:53.995252 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:54.000531 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.001289 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 17:50:53.995505 => 2023-07-08 17:50:54.001244
[0m17:50:54.001455 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:54.019535 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.020567 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m17:50:54.020725 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m17:50:54.020844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:54.779287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:54.799406 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 17:50:54.001552 => 2023-07-08 17:50:54.799363
[0m17:50:54.799664 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m17:50:55.126939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49418761-6523-437c-915d-fd892087b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107212500>]}
[0m17:50:55.127741 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.13s]
[0m17:50:55.128368 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m17:50:55.129068 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.129308 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m17:50:55.129754 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m17:50:55.129921 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.134176 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.135446 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 17:50:55.130500 => 2023-07-08 17:50:55.135282
[0m17:50:55.136150 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:55.139492 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.140229 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m17:50:55.140367 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m17:50:55.140485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:55.786500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:55.789551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 17:50:55.136465 => 2023-07-08 17:50:55.789440
[0m17:50:55.790059 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m17:50:56.108875 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.98s]
[0m17:50:56.109665 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m17:50:56.110241 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.110605 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m17:50:56.111724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m17:50:56.112145 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.117957 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.118468 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 17:50:56.112378 => 2023-07-08 17:50:56.118425
[0m17:50:56.118633 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.122966 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.123691 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m17:50:56.123831 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m17:50:56.123956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:56.725426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:56.728336 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 17:50:56.118734 => 2023-07-08 17:50:56.728234
[0m17:50:56.728766 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m17:50:56.960695 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.85s]
[0m17:50:56.961445 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m17:50:56.961954 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.962443 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m17:50:56.963501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m17:50:56.963914 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.970914 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.971874 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 17:50:56.964158 => 2023-07-08 17:50:56.971811
[0m17:50:56.972121 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:56.975631 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.976614 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m17:50:56.976760 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:50:56.976879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:58.404954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m17:50:58.409008 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 17:50:56.972263 => 2023-07-08 17:50:58.408943
[0m17:50:58.409420 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m17:50:58.682261 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.72s]
[0m17:50:58.683027 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m17:50:58.684810 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:58.685676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:58.686271 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m17:50:58.686500 [info ] [MainThread]: 
[0m17:50:58.686709 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m17:50:58.687453 [debug] [MainThread]: Command end result
[0m17:50:58.695126 [info ] [MainThread]: 
[0m17:50:58.695416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:58.695589 [info ] [MainThread]: 
[0m17:50:58.695741 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:50:58.695962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a32890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c78760>]}
[0m17:50:58.696140 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 18:00:41.629976 | 82033c60-dd7e-4a76-98be-fe80f084380f ==============================
[0m18:00:41.629976 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:00:41.633984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m18:00:41.634175 [debug] [MainThread]: Tracking: tracking
[0m18:00:41.634613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066206a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106621e10>]}
[0m18:00:41.699150 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:00:41.739740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:41.739981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:41.740387 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m18:00:41.747762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074100d0>]}
[0m18:00:41.755430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2350>]}
[0m18:00:41.756039 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:00:41.756704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105716da0>]}
[0m18:00:41.757717 [info ] [MainThread]: 
[0m18:00:41.759382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:41.760737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:00:41.775934 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:00:41.776276 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:00:41.776473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:43.098674 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m18:00:43.106465 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:00:43.440343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m18:00:43.455789 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m18:00:43.456463 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m18:00:43.456738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:44.521056 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m18:00:44.522943 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m18:00:44.880061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745bd60>]}
[0m18:00:44.880748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:44.881004 [info ] [MainThread]: 
[0m18:00:44.884434 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.884700 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m18:00:44.885372 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m18:00:44.885869 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.910312 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.913106 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 18:00:44.886125 => 2023-07-08 18:00:44.913009
[0m18:00:44.913409 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:44.938579 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.939517 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:00:44.939692 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m18:00:44.939841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:45.668973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:45.679469 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 18:00:44.913536 => 2023-07-08 18:00:45.679341
[0m18:00:45.679972 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m18:00:45.976087 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.09s]
[0m18:00:45.978148 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:00:45.978620 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.979077 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m18:00:45.979609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m18:00:45.979780 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.987144 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.988143 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 18:00:45.979895 => 2023-07-08 18:00:45.988023
[0m18:00:45.988581 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:45.991552 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.993468 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:00:45.994246 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m18:00:45.997570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:47.025100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:47.028269 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 18:00:45.988836 => 2023-07-08 18:00:47.028141
[0m18:00:47.028711 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m18:00:47.381489 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.40s]
[0m18:00:47.382242 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:00:47.383211 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.383791 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m18:00:47.384787 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m18:00:47.385288 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.390028 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.392188 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 18:00:47.385598 => 2023-07-08 18:00:47.392108
[0m18:00:47.392537 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:47.422011 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.423232 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:00:47.423413 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - START BACK HERE: then add definitions and tests to the silver model
-- - then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m18:00:47.423566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:48.391383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:48.412737 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 18:00:47.392914 => 2023-07-08 18:00:48.412661
[0m18:00:48.413072 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m18:00:48.708454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82033c60-dd7e-4a76-98be-fe80f084380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d078e0>]}
[0m18:00:48.709292 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.32s]
[0m18:00:48.709834 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:00:48.710937 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.711521 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m18:00:48.712574 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m18:00:48.713022 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.721260 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.722506 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 18:00:48.713315 => 2023-07-08 18:00:48.722436
[0m18:00:48.722744 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:48.726058 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.726819 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:00:48.726990 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m18:00:48.727132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:50.008525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:50.012102 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 18:00:48.722904 => 2023-07-08 18:00:50.011965
[0m18:00:50.012712 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m18:00:50.242256 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.53s]
[0m18:00:50.243017 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:00:50.243541 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.244144 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m18:00:50.245365 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m18:00:50.245844 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.250830 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.251408 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 18:00:50.246080 => 2023-07-08 18:00:50.251358
[0m18:00:50.251630 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:50.253876 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.254808 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:00:50.254973 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m18:00:50.255111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:52.119575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m18:00:52.122555 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 18:00:50.251755 => 2023-07-08 18:00:52.122451
[0m18:00:52.122945 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m18:00:52.449697 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 2.20s]
[0m18:00:52.450398 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:00:52.450888 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.451328 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m18:00:52.452262 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m18:00:52.452623 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.460491 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.461494 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 18:00:52.452830 => 2023-07-08 18:00:52.461401
[0m18:00:52.461818 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:52.465353 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.467089 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:00:52.467280 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:52.467421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:53.886038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:00:53.889105 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 18:00:52.461951 => 2023-07-08 18:00:53.889019
[0m18:00:53.889460 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m18:00:54.259346 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.81s]
[0m18:00:54.260095 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:00:54.261944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:54.262728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:54.262944 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m18:00:54.263138 [info ] [MainThread]: 
[0m18:00:54.263425 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m18:00:54.264014 [debug] [MainThread]: Command end result
[0m18:00:54.274967 [info ] [MainThread]: 
[0m18:00:54.275332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:54.275916 [info ] [MainThread]: 
[0m18:00:54.277405 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:00:54.277983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3f670>]}
[0m18:00:54.278259 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 18:10:45.312505 | bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2 ==============================
[0m18:10:45.312505 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:10:45.317834 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m18:10:45.318104 [debug] [MainThread]: Tracking: tracking
[0m18:10:45.318493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b236a0>]}
[0m18:10:45.385824 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:10:45.422711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:45.422981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:45.423761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m18:10:45.430891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890c0d0>]}
[0m18:10:45.440282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6230>]}
[0m18:10:45.440678 [info ] [MainThread]: Found 1 model, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:10:45.440991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6200>]}
[0m18:10:45.442240 [info ] [MainThread]: 
[0m18:10:45.444181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:45.445206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:10:45.459981 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:10:45.460329 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:10:45.460553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:46.620269 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m18:10:46.622468 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:10:46.908976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m18:10:46.917540 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m18:10:46.917868 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m18:10:46.918079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:47.777862 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m18:10:47.780235 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m18:10:48.078239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953ca0>]}
[0m18:10:48.079508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:48.079990 [info ] [MainThread]: 
[0m18:10:48.083900 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.084230 [info ] [Thread-1 (]: 1 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m18:10:48.085012 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m18:10:48.085285 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.099909 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.101342 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 18:10:48.085458 => 2023-07-08 18:10:48.101269
[0m18:10:48.101641 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:48.122673 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.123971 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m18:10:48.124226 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m18:10:48.124426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:49.183368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:49.196804 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 18:10:48.101796 => 2023-07-08 18:10:49.196724
[0m18:10:49.197154 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m18:10:49.502843 [info ] [Thread-1 (]: 1 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.42s]
[0m18:10:49.505478 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m18:10:49.506150 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.508281 [info ] [Thread-1 (]: 2 of 6 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m18:10:49.509572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m18:10:49.510110 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.517792 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.518740 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 18:10:49.510472 => 2023-07-08 18:10:49.518609
[0m18:10:49.519073 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:49.522125 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.523431 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m18:10:49.523672 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m18:10:49.523863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:50.263073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:50.266064 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 18:10:49.519246 => 2023-07-08 18:10:50.265950
[0m18:10:50.266500 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m18:10:50.486705 [info ] [Thread-1 (]: 2 of 6 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.98s]
[0m18:10:50.487524 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m18:10:50.488499 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.489155 [info ] [Thread-1 (]: 3 of 6 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m18:10:50.490219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m18:10:50.490618 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.495554 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.497808 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 18:10:50.490853 => 2023-07-08 18:10:50.497728
[0m18:10:50.498083 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:50.526006 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.527327 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m18:10:50.527544 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m18:10:50.527732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:51.310880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:51.332650 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 18:10:50.498226 => 2023-07-08 18:10:51.332594
[0m18:10:51.332987 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m18:10:51.638268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc33e52f-e74f-4d81-a3ee-dc4b6e8d65e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091050f0>]}
[0m18:10:51.639113 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.15s]
[0m18:10:51.639677 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m18:10:51.640628 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.641227 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m18:10:51.642354 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m18:10:51.642855 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.650609 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.651539 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 18:10:51.643114 => 2023-07-08 18:10:51.651412
[0m18:10:51.653122 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:51.658734 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.660594 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m18:10:51.660887 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m18:10:51.661503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:53.058942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:53.060746 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 18:10:51.653333 => 2023-07-08 18:10:53.060696
[0m18:10:53.060956 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m18:10:53.359095 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.72s]
[0m18:10:53.359850 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m18:10:53.360352 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.360830 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m18:10:53.361882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m18:10:53.362322 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.368968 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.370208 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 18:10:53.362571 => 2023-07-08 18:10:53.370023
[0m18:10:53.370831 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:53.373968 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.374999 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m18:10:53.375194 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m18:10:53.375366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:54.408133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:54.411004 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 18:10:53.371205 => 2023-07-08 18:10:54.410928
[0m18:10:54.411299 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m18:10:54.720080 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.36s]
[0m18:10:54.720840 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m18:10:54.721309 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.721694 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m18:10:54.722639 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m18:10:54.723077 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.734687 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.736106 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 18:10:54.723334 => 2023-07-08 18:10:54.736017
[0m18:10:54.736436 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:54.740030 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.741183 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m18:10:54.741381 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:54.741554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:55.535967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m18:10:55.538939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 18:10:54.736631 => 2023-07-08 18:10:55.538837
[0m18:10:55.539363 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m18:10:55.859992 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.14s]
[0m18:10:55.860454 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m18:10:55.862195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:55.862978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:55.863268 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m18:10:55.863568 [info ] [MainThread]: 
[0m18:10:55.863951 [info ] [MainThread]: Finished running 5 tests, 1 view model in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m18:10:55.864702 [debug] [MainThread]: Command end result
[0m18:10:55.874882 [info ] [MainThread]: 
[0m18:10:55.875530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:55.875982 [info ] [MainThread]: 
[0m18:10:55.876412 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:10:55.877019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108953ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940e890>]}
[0m18:10:55.877463 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:01:07.733273 | c4e269fb-3f3c-42ad-ab8a-bc51bf26432d ==============================
[0m19:01:07.733273 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:01:07.745887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:01:07.746678 [debug] [MainThread]: Tracking: tracking
[0m19:01:07.747455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bde40>]}
[0m19:01:07.974282 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:01:08.097220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:08.098649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:08.099559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:01:08.114483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087340d0>]}
[0m19:01:08.136048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084764d0>]}
[0m19:01:08.137348 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:01:08.137849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084765f0>]}
[0m19:01:08.143665 [info ] [MainThread]: 
[0m19:01:08.147235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:08.148454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:01:08.185189 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:01:08.187512 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:01:08.188194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:09.645369 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:01:09.651052 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:01:09.892090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:01:09.911129 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:01:09.911517 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:01:09.912033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.810508 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:01:10.819251 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:01:11.031710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475570>]}
[0m19:01:11.037908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:11.038352 [info ] [MainThread]: 
[0m19:01:11.057128 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.057769 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:01:11.059117 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:01:11.059847 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.068160 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.069985 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:01:11.060156 => 2023-07-08 19:01:11.069713
[0m19:01:11.075743 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:11.164283 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.166056 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:11.166685 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:01:11.166991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:11.818050 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb5-0504-a336-0050-3987000b50a6
[0m19:01:11.819176 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:01:11.820576 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:01:11.076087 => 2023-07-08 19:01:11.820332
[0m19:01:11.821348 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:01:12.060142 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:12.061699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109428220>]}
[0m19:01:12.062836 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 1.00s]
[0m19:01:12.070131 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:12.071033 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.071632 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:01:12.072737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:01:12.073268 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.111136 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.112656 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:01:12.073541 => 2023-07-08 19:01:12.112514
[0m19:01:12.113077 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.152759 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.154611 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:12.155158 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:01:12.155532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:12.751012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:12.770166 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:01:12.113556 => 2023-07-08 19:01:12.770070
[0m19:01:12.770780 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:01:12.952229 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.88s]
[0m19:01:12.953044 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:12.953595 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.954109 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:01:12.955281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:01:12.955584 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.960834 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.961493 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:01:12.955734 => 2023-07-08 19:01:12.961406
[0m19:01:12.961720 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:12.965349 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.966359 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:12.966541 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:01:12.966696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:13.501720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:13.504956 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:01:12.961856 => 2023-07-08 19:01:13.504833
[0m19:01:13.505434 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:01:13.689004 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.73s]
[0m19:01:13.689839 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:13.697208 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.698237 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:01:13.698912 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:01:13.699120 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.704450 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.705631 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:01:13.699255 => 2023-07-08 19:01:13.705528
[0m19:01:13.706304 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:13.712371 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.714408 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:13.714922 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:01:13.715233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:14.424204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:14.448389 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:01:13.706615 => 2023-07-08 19:01:14.448335
[0m19:01:14.448688 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:01:14.628908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e269fb-3f3c-42ad-ab8a-bc51bf26432d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475570>]}
[0m19:01:14.629414 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.93s]
[0m19:01:14.629756 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:14.630462 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.630838 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:01:14.631475 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:01:14.631813 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.639381 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.640029 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:01:14.632178 => 2023-07-08 19:01:14.639970
[0m19:01:14.640268 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:14.643052 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.643899 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:14.644080 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:01:14.644254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:16.633511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:01:16.636894 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:01:14.640419 => 2023-07-08 19:01:16.636783
[0m19:01:16.637345 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:01:16.807805 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 2.18s]
[0m19:01:16.808579 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:16.809074 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.809426 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:01:16.810358 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:01:16.810812 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.819198 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.820450 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:01:16.811068 => 2023-07-08 19:01:16.820338
[0m19:01:16.820703 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:16.824011 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.825254 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:16.825479 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:01:16.825646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:17.758943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:17.761987 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:01:16.820845 => 2023-07-08 19:01:17.761873
[0m19:01:17.762384 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:01:17.965059 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.15s]
[0m19:01:17.965866 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:17.966395 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.966864 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:01:17.967809 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:01:17.968205 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.979642 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.980272 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:01:17.968425 => 2023-07-08 19:01:17.980216
[0m19:01:17.980489 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:17.983919 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.985096 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:17.985317 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:01:17.985484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:18.749599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:18.752879 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:01:17.980622 => 2023-07-08 19:01:18.752747
[0m19:01:18.753379 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:01:18.955775 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 0.99s]
[0m19:01:18.956571 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:18.958471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:18.959341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:18.959653 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:01:18.960038 [info ] [MainThread]: 
[0m19:01:18.960553 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m19:01:18.961433 [debug] [MainThread]: Command end result
[0m19:01:18.971309 [info ] [MainThread]: 
[0m19:01:18.971754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:18.972265 [info ] [MainThread]: 
[0m19:01:18.973005 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:01:18.973705 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:01:18.974004 [error] [MainThread]:   Missing column specification
[0m19:01:18.974215 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:18.974808 [info ] [MainThread]: 
[0m19:01:18.975225 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:01:18.975757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd68c0>]}
[0m19:01:18.976054 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:01:37.025495 | eccd8a98-f36e-4b26-abc2-82c0e48dc6cc ==============================
[0m19:01:37.025495 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:01:37.029249 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:01:37.029429 [debug] [MainThread]: Tracking: tracking
[0m19:01:37.029716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115527790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115525de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115524ee0>]}
[0m19:01:37.098580 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:01:37.144101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:37.144376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:37.144902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:01:37.153216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161300d0>]}
[0m19:01:37.167332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156de500>]}
[0m19:01:37.168332 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:01:37.168900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114531e70>]}
[0m19:01:37.172297 [info ] [MainThread]: 
[0m19:01:37.175634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:37.177227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:01:37.198825 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:01:37.199158 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:01:37.199351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:38.080825 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:01:38.083201 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:01:38.277138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:01:38.288818 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:01:38.289166 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:01:38.289353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:38.966951 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:01:38.968447 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:01:39.136635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116176b90>]}
[0m19:01:39.138883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:39.139273 [info ] [MainThread]: 
[0m19:01:39.142923 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.143273 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:01:39.143880 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:01:39.144120 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.146006 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.146922 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:01:39.144272 => 2023-07-08 19:01:39.146854
[0m19:01:39.147175 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.181247 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.182777 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:01:39.183005 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:01:39.183305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:39.699333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb5-0504-a396-0050-3987000b601a
[0m19:01:39.699635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:01:39.699916 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:01:39.147321 => 2023-07-08 19:01:39.699867
[0m19:01:39.700365 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:01:39.868241 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:39.868683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a31030>]}
[0m19:01:39.869054 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 0.73s]
[0m19:01:39.870490 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:01:39.870776 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.871090 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:01:39.871943 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:01:39.872391 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.889839 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.890841 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:01:39.872666 => 2023-07-08 19:01:39.890755
[0m19:01:39.891098 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:39.907603 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.908583 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:01:39.908763 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:01:39.908923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:40.403085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0 seconds
[0m19:01:40.409231 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:01:39.891239 => 2023-07-08 19:01:40.409173
[0m19:01:40.409476 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:01:40.624675 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.75s]
[0m19:01:40.625486 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:01:40.626026 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.626529 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:01:40.627528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:01:40.627937 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.634362 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.634989 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:01:40.628166 => 2023-07-08 19:01:40.634935
[0m19:01:40.635204 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:40.638222 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.639704 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:01:40.640080 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:01:40.640337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:41.342935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:41.345933 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:01:40.635336 => 2023-07-08 19:01:41.345824
[0m19:01:41.346560 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:01:41.536043 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.91s]
[0m19:01:41.536794 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:01:41.537751 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.538436 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:01:41.539425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:01:41.539809 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.543218 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.544218 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:01:41.540069 => 2023-07-08 19:01:41.544107
[0m19:01:41.544630 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:41.547812 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.549439 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:01:41.549689 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:01:41.549849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:42.201263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:42.224791 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:01:41.544803 => 2023-07-08 19:01:42.224740
[0m19:01:42.225080 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:01:42.401228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccd8a98-f36e-4b26-abc2-82c0e48dc6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ca9600>]}
[0m19:01:42.402103 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.86s]
[0m19:01:42.402678 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:01:42.403768 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.404171 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:01:42.405368 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:01:42.406252 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.411685 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.412250 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:01:42.406470 => 2023-07-08 19:01:42.412196
[0m19:01:42.412457 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:42.417781 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.418922 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:01:42.419127 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:01:42.419283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:43.292365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:43.294172 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:01:42.412590 => 2023-07-08 19:01:43.294121
[0m19:01:43.294383 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:01:43.500859 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.10s]
[0m19:01:43.501289 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:01:43.501660 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.501917 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:01:43.502508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:01:43.502675 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.506268 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.506967 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:01:43.502788 => 2023-07-08 19:01:43.506917
[0m19:01:43.507151 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:43.509303 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.510111 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:01:43.510256 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:01:43.510389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:44.047651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:01:44.049382 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:01:43.507267 => 2023-07-08 19:01:44.049333
[0m19:01:44.049573 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:01:44.220477 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.72s]
[0m19:01:44.221257 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:01:44.221791 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.222260 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:01:44.223281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:01:44.223716 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.232430 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.232982 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:01:44.224097 => 2023-07-08 19:01:44.232932
[0m19:01:44.233172 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:44.235471 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.237096 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:01:44.237309 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:01:44.237455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:45.829863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:01:45.832895 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:01:44.233290 => 2023-07-08 19:01:45.832776
[0m19:01:45.833360 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:01:45.993004 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.77s]
[0m19:01:45.993787 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:01:45.995513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:45.996364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:45.996692 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:01:45.997197 [info ] [MainThread]: 
[0m19:01:45.997528 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m19:01:45.998084 [debug] [MainThread]: Command end result
[0m19:01:46.006458 [info ] [MainThread]: 
[0m19:01:46.006819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:46.007113 [info ] [MainThread]: 
[0m19:01:46.007476 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:01:46.007715 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:01:46.007951 [error] [MainThread]:   Missing column specification
[0m19:01:46.008460 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:01:46.008888 [info ] [MainThread]: 
[0m19:01:46.009284 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:01:46.009818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ba2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b527a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116176b90>]}
[0m19:01:46.010250 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:03:07.825209 | 54100bf1-5270-46ca-b8fe-0ceda0509383 ==============================
[0m19:03:07.825209 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:07.832089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:07.832369 [debug] [MainThread]: Tracking: tracking
[0m19:03:07.833200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37de40>]}
[0m19:03:07.964680 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:08.041074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:08.041537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:08.042333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:08.051736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf300d0>]}
[0m19:03:08.065189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a4d0>]}
[0m19:03:08.071956 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:08.074005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a5f0>]}
[0m19:03:08.076614 [info ] [MainThread]: 
[0m19:03:08.086608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:08.094127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:08.129246 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:08.129827 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:08.130397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:09.185952 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:09.189611 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:09.418268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:03:09.429295 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:03:09.429737 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:03:09.430400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:10.334176 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:03:10.336644 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:03:11.090332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf76a40>]}
[0m19:03:11.091908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:11.092375 [info ] [MainThread]: 
[0m19:03:11.096749 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.097217 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:03:11.098133 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:03:11.098579 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.101489 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.102552 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:03:11.098853 => 2023-07-08 19:03:11.102468
[0m19:03:11.102852 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:11.146084 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.147512 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:11.148087 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:03:11.148302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:11.933187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7eb7-0504-a396-0050-3987000b6032
[0m19:03:11.933504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:03:11.933792 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:03:11.103023 => 2023-07-08 19:03:11.933742
[0m19:03:11.933978 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:03:12.195871 [debug] [Thread-1 (]: Database Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:03:12.196585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c82cf40>]}
[0m19:03:12.197182 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model DBT_NDW.distinct_num_baths_per_iteration .. [[31mERROR[0m in 1.10s]
[0m19:03:12.199881 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:12.200581 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.201123 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:03:12.202046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:03:12.202520 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.217932 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.218939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:03:12.203386 => 2023-07-08 19:03:12.218789
[0m19:03:12.219476 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:12.242154 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.243159 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:12.243338 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:03:12.243496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:13.075948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:13.086509 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:03:12.219772 => 2023-07-08 19:03:13.086435
[0m19:03:13.086807 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:03:13.327790 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.13s]
[0m19:03:13.328257 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:13.328531 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.328790 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:03:13.329342 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:03:13.329590 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.334998 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.335827 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:03:13.329736 => 2023-07-08 19:03:13.335728
[0m19:03:13.336063 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:13.338609 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.339863 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:13.340326 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:03:13.340509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:13.934112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:13.936969 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:03:13.336203 => 2023-07-08 19:03:13.936878
[0m19:03:13.937349 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:03:14.159944 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.83s]
[0m19:03:14.160740 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:14.161888 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.162304 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:03:14.162944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:03:14.163154 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.165922 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.166884 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:03:14.163290 => 2023-07-08 19:03:14.166824
[0m19:03:14.168268 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:14.173611 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.174978 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:14.175205 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:03:14.175370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:16.335482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:03:16.366822 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:03:14.168499 => 2023-07-08 19:03:16.366732
[0m19:03:16.367375 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:03:16.611570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54100bf1-5270-46ca-b8fe-0ceda0509383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf77250>]}
[0m19:03:16.612398 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 2.45s]
[0m19:03:16.612978 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:16.613993 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.614612 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:03:16.615377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:03:16.615631 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.619902 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.620866 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:03:16.615782 => 2023-07-08 19:03:16.620808
[0m19:03:16.621094 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:16.623445 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.624279 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:16.624481 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:03:16.624647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:17.770235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:17.773405 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:03:16.621228 => 2023-07-08 19:03:17.773291
[0m19:03:17.773840 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:03:17.964673 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.35s]
[0m19:03:17.965419 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:17.965881 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.966339 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:03:17.967305 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:03:17.967694 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.973009 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.973702 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:03:17.967927 => 2023-07-08 19:03:17.973642
[0m19:03:17.973948 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:17.976722 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.977795 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:17.978238 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:03:17.978653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:18.805407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:18.808723 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:03:17.974100 => 2023-07-08 19:03:18.808611
[0m19:03:18.809162 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:03:19.035435 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.07s]
[0m19:03:19.036234 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:19.036744 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.037205 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:03:19.038464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:03:19.038891 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.052091 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.053342 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:03:19.039125 => 2023-07-08 19:03:19.053166
[0m19:03:19.053932 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:19.057759 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.058849 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:19.059045 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:19.059202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:19.920224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:19.923031 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:03:19.054254 => 2023-07-08 19:03:19.922936
[0m19:03:19.923438 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:03:20.088108 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.05s]
[0m19:03:20.088889 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:20.090715 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:20.091519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:20.091763 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:03:20.091990 [info ] [MainThread]: 
[0m19:03:20.092287 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m19:03:20.092810 [debug] [MainThread]: Command end result
[0m19:03:20.100762 [info ] [MainThread]: 
[0m19:03:20.101123 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:03:20.101332 [info ] [MainThread]: 
[0m19:03:20.101738 [error] [MainThread]: [33mDatabase Error in model distinct_num_baths_per_iteration (models/marts/core/distinct_num_baths_per_iteration.sql)[0m
[0m19:03:20.102253 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:03:20.102488 [error] [MainThread]:   Missing column specification
[0m19:03:20.102871 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/distinct_num_baths_per_iteration.sql
[0m19:03:20.103122 [info ] [MainThread]: 
[0m19:03:20.103361 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:03:20.103689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53a140>]}
[0m19:03:20.104053 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:03:39.534450 | 06baad50-0326-4e18-891d-d1ec1215f278 ==============================
[0m19:03:39.534450 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:39.538648 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:39.538947 [debug] [MainThread]: Tracking: tracking
[0m19:03:39.539336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113827730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113825de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113826e90>]}
[0m19:03:39.623485 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:39.678954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:39.679265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:39.679808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:39.690063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450c0d0>]}
[0m19:03:39.700019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144da4d0>]}
[0m19:03:39.700700 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:39.701170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06baad50-0326-4e18-891d-d1ec1215f278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11035e5f0>]}
[0m19:03:39.702414 [info ] [MainThread]: 
[0m19:03:39.705680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:39.706766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:39.726445 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:39.726749 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:39.726943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:40.832345 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:40.833718 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:41.149954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:41.150268 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m19:03:41.150453 [info ] [MainThread]: 
[0m19:03:41.150703 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m19:03:41.151088 [debug] [MainThread]: Flushing usage events
[0m19:03:41.450167 [info ] [MainThread]: ctrl-c


============================== 2023-07-08 19:03:47.455314 | 62b566da-2bdd-41f7-9d62-c4441a241023 ==============================
[0m19:03:47.455314 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:03:47.460612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:03:47.461036 [debug] [MainThread]: Tracking: tracking
[0m19:03:47.461582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11231de40>]}
[0m19:03:47.535702 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:03:47.573605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:03:47.573910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:03:47.574461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:03:47.584701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137180d0>]}
[0m19:03:47.598756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e64d0>]}
[0m19:03:47.599141 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:03:47.599422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e65f0>]}
[0m19:03:47.600775 [info ] [MainThread]: 
[0m19:03:47.602559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:47.603567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:03:47.620938 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:03:47.622006 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:03:47.622270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:48.575958 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:03:48.578531 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:03:48.903693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:03:48.914836 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:03:48.915140 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:03:48.915330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:49.580622 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m19:03:49.583022 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:03:49.872643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>]}
[0m19:03:49.873736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:49.874253 [info ] [MainThread]: 
[0m19:03:49.878260 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.878620 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:03:49.879321 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:03:49.879561 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.883153 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.883790 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:03:49.879718 => 2023-07-08 19:03:49.883722
[0m19:03:49.884021 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:49.917831 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.919351 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:03:49.919602 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as the_count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:03:49.919810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:50.793485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:50.813809 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:03:49.884159 => 2023-07-08 19:03:50.813755
[0m19:03:50.814126 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:03:50.992648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12000b5b0>]}
[0m19:03:50.993447 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.11s]
[0m19:03:50.995996 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:03:50.997070 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:50.997368 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:03:50.998432 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:03:50.998666 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:51.014595 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.015837 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:03:50.998902 => 2023-07-08 19:03:51.015712
[0m19:03:51.016286 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:51.035634 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.036730 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:03:51.036928 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:03:51.037090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:51.827387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:51.838043 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:03:51.016514 => 2023-07-08 19:03:51.837968
[0m19:03:51.838375 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:03:52.000335 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.00s]
[0m19:03:52.001150 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:03:52.001689 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.002186 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:03:52.003183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:03:52.003569 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.010452 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.011110 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:03:52.003783 => 2023-07-08 19:03:52.011055
[0m19:03:52.011323 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:52.016003 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.017579 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:03:52.017839 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:03:52.018021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.911930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:52.915274 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:03:52.011459 => 2023-07-08 19:03:52.915154
[0m19:03:52.915748 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:03:53.166368 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.16s]
[0m19:03:53.167142 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:03:53.168032 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.168781 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:03:53.169808 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:03:53.170217 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.174144 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.175544 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:03:53.170491 => 2023-07-08 19:03:53.175464
[0m19:03:53.175859 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:53.179374 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.180525 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:03:53.180694 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:03:53.180847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:53.975063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:53.982596 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:03:53.176004 => 2023-07-08 19:03:53.982513
[0m19:03:53.983091 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:03:54.144122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b566da-2bdd-41f7-9d62-c4441a241023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>]}
[0m19:03:54.144915 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.97s]
[0m19:03:54.145468 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:03:54.146452 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.146916 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:03:54.147930 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:03:54.148329 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.152672 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.153381 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:03:54.148483 => 2023-07-08 19:03:54.153310
[0m19:03:54.153627 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.156104 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.156944 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:03:54.157123 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:03:54.157278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:54.805361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:54.808263 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:03:54.153796 => 2023-07-08 19:03:54.808190
[0m19:03:54.808563 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:03:54.973595 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.83s]
[0m19:03:54.974398 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:03:54.974936 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.975412 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:03:54.976410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:03:54.977022 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.985141 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.985749 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:03:54.977330 => 2023-07-08 19:03:54.985696
[0m19:03:54.985964 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:54.988436 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.989236 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:03:54.989393 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:03:54.989535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:55.665184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:55.668080 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:03:54.986099 => 2023-07-08 19:03:55.667984
[0m19:03:55.668457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:03:55.967887 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.99s]
[0m19:03:55.968642 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:03:55.969144 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.969659 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:03:55.970694 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:03:55.971089 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.979524 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.980136 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:03:55.971304 => 2023-07-08 19:03:55.980082
[0m19:03:55.980349 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:55.982828 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.983742 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:03:55.983917 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:03:55.984067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:56.748296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:03:56.752098 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:03:55.980478 => 2023-07-08 19:03:56.752026
[0m19:03:56.752382 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:03:57.103205 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.13s]
[0m19:03:57.103957 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:03:57.105710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:57.106729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:57.106988 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:03:57.107209 [info ] [MainThread]: 
[0m19:03:57.107454 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m19:03:57.108056 [debug] [MainThread]: Command end result
[0m19:03:57.116239 [info ] [MainThread]: 
[0m19:03:57.116618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:57.117211 [info ] [MainThread]: 
[0m19:03:57.117647 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:03:57.118195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113763e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202055a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120206e60>]}
[0m19:03:57.118671 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:04:06.831152 | b0273d83-299e-43cd-8062-0533fbd19500 ==============================
[0m19:04:06.831152 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:04:06.850562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:04:06.850906 [debug] [MainThread]: Tracking: tracking
[0m19:04:06.851884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611f670>]}
[0m19:04:07.025410 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:04:07.118417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:07.118900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:07.119769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:04:07.140141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de00d0>]}
[0m19:04:07.154960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa470>]}
[0m19:04:07.163353 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:04:07.164803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa590>]}
[0m19:04:07.167041 [info ] [MainThread]: 
[0m19:04:07.168527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:07.170849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:04:07.197234 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:04:07.197772 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:04:07.198248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:08.539048 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:04:08.542103 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:04:08.850815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:04:08.862748 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:04:08.863460 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:04:08.863888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:09.827607 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:04:09.829759 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:04:10.143756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e272e0>]}
[0m19:04:10.144744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:10.145119 [info ] [MainThread]: 
[0m19:04:10.149938 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.150441 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:04:10.151149 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:04:10.151425 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.153296 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.153926 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:04:10.151609 => 2023-07-08 19:04:10.153828
[0m19:04:10.157046 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:10.208109 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.216349 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:04:10.216997 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
  );
[0m19:04:10.217307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:11.125649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:11.149365 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:04:10.157300 => 2023-07-08 19:04:11.149306
[0m19:04:11.149727 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:04:11.322686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb6740>]}
[0m19:04:11.323530 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.17s]
[0m19:04:11.327065 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:04:11.327783 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.328339 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:04:11.329083 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:04:11.329327 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.348512 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.349660 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:04:11.329493 => 2023-07-08 19:04:11.349574
[0m19:04:11.349974 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:11.373035 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.375477 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:04:11.375759 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:04:11.375969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:12.119103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:12.126968 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:04:11.350140 => 2023-07-08 19:04:12.126895
[0m19:04:12.127268 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:04:12.384354 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.06s]
[0m19:04:12.384969 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:04:12.385542 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.385855 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:04:12.386392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:04:12.386581 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.391496 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.392551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:04:12.386713 => 2023-07-08 19:04:12.392402
[0m19:04:12.392904 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:12.395800 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.397024 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:04:12.397229 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:04:12.397403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:12.952124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:12.954005 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:04:12.393081 => 2023-07-08 19:04:12.953948
[0m19:04:12.954231 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:04:13.273262 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.89s]
[0m19:04:13.274125 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:04:13.276764 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.277138 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:04:13.277903 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:04:13.278098 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.280907 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.281678 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:04:13.278231 => 2023-07-08 19:04:13.281623
[0m19:04:13.281885 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:13.287347 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.288700 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:04:13.288905 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:04:13.289082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:14.132816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:14.136561 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:04:13.282014 => 2023-07-08 19:04:14.136475
[0m19:04:14.137476 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:04:14.353603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0273d83-299e-43cd-8062-0533fbd19500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da94b0>]}
[0m19:04:14.354417 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.08s]
[0m19:04:14.355012 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:04:14.356109 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.356655 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:04:14.357525 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:04:14.357805 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.362799 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.363670 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:04:14.357957 => 2023-07-08 19:04:14.363609
[0m19:04:14.363895 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:14.366539 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.367442 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:04:14.367645 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:04:14.367804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:15.107290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:15.110272 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:04:14.364033 => 2023-07-08 19:04:15.110155
[0m19:04:15.110749 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:04:15.422592 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.07s]
[0m19:04:15.423361 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:04:15.423846 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.424332 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:04:15.425348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:04:15.425899 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.431898 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.432523 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:04:15.426132 => 2023-07-08 19:04:15.432465
[0m19:04:15.432745 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:15.436012 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.436903 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:04:15.437083 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:04:15.437240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:16.350472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:16.353498 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:04:15.432898 => 2023-07-08 19:04:16.353383
[0m19:04:16.353972 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:04:16.618517 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.19s]
[0m19:04:16.619248 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:04:16.619749 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.620150 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:04:16.621203 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:04:16.621634 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.632283 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.634159 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:04:16.621861 => 2023-07-08 19:04:16.634037
[0m19:04:16.634600 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:16.638350 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.639350 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:04:16.639528 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:04:16.639686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:17.478042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:04:17.480966 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:04:16.634831 => 2023-07-08 19:04:17.480854
[0m19:04:17.481405 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:04:17.738262 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.12s]
[0m19:04:17.739355 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:04:17.741014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:17.741750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:17.743425 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:04:17.743714 [info ] [MainThread]: 
[0m19:04:17.744035 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m19:04:17.744971 [debug] [MainThread]: Command end result
[0m19:04:17.753885 [info ] [MainThread]: 
[0m19:04:17.754344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:17.754885 [info ] [MainThread]: 
[0m19:04:17.755214 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:04:17.755605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dd360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa5c0>]}
[0m19:04:17.755842 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:05:05.988891 | 2d50c059-67d6-43d5-9e79-310ac63f429d ==============================
[0m19:05:05.988891 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:05:05.996301 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:05:05.996751 [debug] [MainThread]: Tracking: tracking
[0m19:05:05.997401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbf790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbdde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbcee0>]}
[0m19:05:06.195501 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:05:06.259992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:06.260682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:06.261573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:05:06.271895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132340d0>]}
[0m19:05:06.293630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f76590>]}
[0m19:05:06.294155 [info ] [MainThread]: Found 2 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:05:06.295811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa26b0>]}
[0m19:05:06.298917 [info ] [MainThread]: 
[0m19:05:06.302577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:06.308977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:05:06.340212 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:05:06.340899 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:05:06.341232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:07.690982 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:05:07.701475 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:05:07.889759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:05:07.904734 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:05:07.905354 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:05:07.905703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:08.863611 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:05:08.866689 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:05:09.208084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327b1f0>]}
[0m19:05:09.209116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:09.209451 [info ] [MainThread]: 
[0m19:05:09.216104 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.216627 [info ] [Thread-1 (]: 1 of 7 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:05:09.217335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:05:09.217909 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.220840 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.221714 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:05:09.218198 => 2023-07-08 19:05:09.221606
[0m19:05:09.222111 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:09.277329 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.278929 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:05:09.279198 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:05:09.279369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:10.262756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:10.285918 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:05:09.222348 => 2023-07-08 19:05:10.285855
[0m19:05:10.286255 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:05:10.558111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9e800>]}
[0m19:05:10.558896 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.34s]
[0m19:05:10.561428 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:05:10.562105 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.562653 [info ] [Thread-1 (]: 2 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:05:10.563742 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:05:10.564163 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.585118 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.586051 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:05:10.564393 => 2023-07-08 19:05:10.585987
[0m19:05:10.586514 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:10.609217 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.610344 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:05:10.610566 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:05:10.610758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:11.190443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:11.200326 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:05:10.586753 => 2023-07-08 19:05:11.200254
[0m19:05:11.200630 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:05:11.426557 [info ] [Thread-1 (]: 2 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.86s]
[0m19:05:11.427370 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:05:11.427897 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.428396 [info ] [Thread-1 (]: 3 of 7 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:05:11.429389 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:05:11.429798 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.436433 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.437847 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:05:11.430118 => 2023-07-08 19:05:11.437743
[0m19:05:11.438210 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:11.441548 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.442469 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:05:11.442671 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:05:11.442833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:12.150976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:12.154080 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:05:11.438577 => 2023-07-08 19:05:12.153977
[0m19:05:12.154498 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:05:12.454435 [info ] [Thread-1 (]: 3 of 7 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.03s]
[0m19:05:12.455178 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:05:12.456122 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.456727 [info ] [Thread-1 (]: 4 of 7 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:05:12.457806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:05:12.458232 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.461527 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.462640 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:05:12.458524 => 2023-07-08 19:05:12.462578
[0m19:05:12.462870 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:12.467310 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.468723 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:05:12.468899 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:05:12.469054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:13.314772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:13.317196 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:05:12.463007 => 2023-07-08 19:05:13.317149
[0m19:05:13.317465 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:05:13.628265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d50c059-67d6-43d5-9e79-310ac63f429d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114224250>]}
[0m19:05:13.629095 [info ] [Thread-1 (]: 4 of 7 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.17s]
[0m19:05:13.629688 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:05:13.630659 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.631108 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:05:13.632037 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:05:13.632404 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.639116 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.640292 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:05:13.632621 => 2023-07-08 19:05:13.640213
[0m19:05:13.640566 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:13.643829 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.645244 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:05:13.645508 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:05:13.645694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:14.279031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:14.282315 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:05:13.640725 => 2023-07-08 19:05:14.282192
[0m19:05:14.282823 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:05:14.544722 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 0.91s]
[0m19:05:14.545237 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:05:14.545531 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.545862 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:05:14.546751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:05:14.547178 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.553191 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.554032 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:05:14.547409 => 2023-07-08 19:05:14.553970
[0m19:05:14.554391 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:14.557767 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.559209 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:05:14.559594 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:05:14.559873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:15.189885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:15.192808 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:05:14.554875 => 2023-07-08 19:05:15.192702
[0m19:05:15.193252 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:05:15.492325 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 0.95s]
[0m19:05:15.493103 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:05:15.493607 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.494085 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:05:15.495087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:05:15.495521 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.505555 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.506184 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:05:15.495736 => 2023-07-08 19:05:15.506131
[0m19:05:15.506397 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:15.510569 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.512148 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:05:15.512402 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:05:15.512570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:16.549159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:05:16.552156 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:05:15.506534 => 2023-07-08 19:05:16.552038
[0m19:05:16.552623 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:05:16.738382 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.24s]
[0m19:05:16.739139 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:05:16.740803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:16.741629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:16.741944 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:05:16.742281 [info ] [MainThread]: 
[0m19:05:16.742766 [info ] [MainThread]: Finished running 2 view models, 5 tests in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m19:05:16.743592 [debug] [MainThread]: Command end result
[0m19:05:16.751624 [info ] [MainThread]: 
[0m19:05:16.752117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:16.752398 [info ] [MainThread]: 
[0m19:05:16.753177 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:05:16.753570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141fad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114163d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9e2f0>]}
[0m19:05:16.753952 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:07:11.235517 | ac14bdd8-12a7-40b2-bf22-308478f22ef7 ==============================
[0m19:07:11.235517 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:07:11.240221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:07:11.240516 [debug] [MainThread]: Tracking: tracking
[0m19:07:11.240959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104607f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721f6a0>]}
[0m19:07:11.339276 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:07:11.390864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:07:11.391173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:07:11.391792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:07:11.400910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844340>]}
[0m19:07:11.415145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2860>]}
[0m19:07:11.415773 [info ] [MainThread]: Found 3 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:07:11.416136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb9e70>]}
[0m19:07:11.418045 [info ] [MainThread]: 
[0m19:07:11.421068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:11.422288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:07:11.447481 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:07:11.447861 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:07:11.448080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:12.748255 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:07:12.749680 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:07:13.035975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:07:13.049877 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:07:13.050460 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:07:13.050787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:13.652508 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m19:07:13.654013 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:07:13.887844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788b1f0>]}
[0m19:07:13.889097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:13.889458 [info ] [MainThread]: 
[0m19:07:13.894216 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.894879 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:07:13.895492 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:07:13.895683 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.897441 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.899029 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:07:13.895917 => 2023-07-08 19:07:13.898956
[0m19:07:13.899278 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:13.936908 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.938070 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:07:13.938272 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:07:13.938452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:15.023856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:15.047511 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:07:13.899416 => 2023-07-08 19:07:15.047413
[0m19:07:15.047997 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:07:15.388642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee60e0>]}
[0m19:07:15.389452 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.49s]
[0m19:07:15.392034 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:07:15.392682 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.393306 [info ] [Thread-1 (]: 2 of 8 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:07:15.395265 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:07:15.395485 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.397217 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.397858 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:07:15.395624 => 2023-07-08 19:07:15.397730
[0m19:07:15.398317 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:15.403663 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.404757 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:07:15.404946 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:07:15.405115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:16.512674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:16.515845 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:07:15.398569 => 2023-07-08 19:07:16.515755
[0m19:07:16.516284 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:07:16.859759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f39150>]}
[0m19:07:16.860639 [info ] [Thread-1 (]: 2 of 8 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.46s]
[0m19:07:16.861188 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:07:16.861659 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.862156 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:07:16.863171 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:07:16.863591 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.877994 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.879397 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:07:16.863909 => 2023-07-08 19:07:16.879327
[0m19:07:16.879634 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:16.902425 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.903922 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:07:16.904540 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:07:16.904774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:17.537778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:17.547551 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:07:16.880076 => 2023-07-08 19:07:17.547470
[0m19:07:17.547865 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:07:17.760068 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.90s]
[0m19:07:17.760541 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:07:17.760812 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.761077 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:07:17.761884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:07:17.762195 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.766593 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.767277 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:07:17.762339 => 2023-07-08 19:07:17.767104
[0m19:07:17.767750 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:17.772475 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.773655 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:07:17.774104 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:07:17.774489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:18.710449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:18.712313 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:07:17.767979 => 2023-07-08 19:07:18.712257
[0m19:07:18.712533 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:07:18.933412 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 1.17s]
[0m19:07:18.934376 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:07:18.935466 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.936101 [info ] [Thread-1 (]: 5 of 8 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:07:18.937044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:07:18.937428 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.941125 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.942558 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:07:18.937647 => 2023-07-08 19:07:18.942465
[0m19:07:18.943018 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:18.946176 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.948161 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:07:18.948921 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:07:18.949127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:19.666959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:19.670415 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:07:18.943170 => 2023-07-08 19:07:19.670335
[0m19:07:19.670841 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:07:19.833787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14bdd8-12a7-40b2-bf22-308478f22ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faf9a0>]}
[0m19:07:19.834666 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.90s]
[0m19:07:19.835273 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:07:19.836279 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.836729 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:07:19.837863 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:07:19.838296 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.846772 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.848131 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:07:19.838538 => 2023-07-08 19:07:19.847984
[0m19:07:19.848529 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:19.854239 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.856420 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:07:19.856929 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:07:19.857264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:20.570714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:20.573704 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:07:19.849148 => 2023-07-08 19:07:20.573602
[0m19:07:20.574101 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:07:21.272458 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.43s]
[0m19:07:21.273485 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:07:21.274348 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.274682 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:07:21.275551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:07:21.275836 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.284445 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.287005 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:07:21.276046 => 2023-07-08 19:07:21.286924
[0m19:07:21.287285 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:21.289953 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.291186 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:07:21.291392 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:07:21.291558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:21.898849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:21.902422 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:07:21.287428 => 2023-07-08 19:07:21.902278
[0m19:07:21.902925 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:07:22.319855 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.04s]
[0m19:07:22.320650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:07:22.321251 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.321660 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:07:22.322668 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:07:22.323293 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.332025 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.332841 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:07:22.323605 => 2023-07-08 19:07:22.332704
[0m19:07:22.333324 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:22.336637 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.337816 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:07:22.338036 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:07:22.338228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:23.438619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:07:23.441312 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:07:22.333593 => 2023-07-08 19:07:23.441200
[0m19:07:23.441752 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:07:23.618491 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.30s]
[0m19:07:23.618945 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:07:23.620906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:23.621843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:23.622205 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:07:23.622559 [info ] [MainThread]: 
[0m19:07:23.623205 [info ] [MainThread]: Finished running 3 view models, 5 tests in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m19:07:23.624320 [debug] [MainThread]: Command end result
[0m19:07:23.637490 [info ] [MainThread]: 
[0m19:07:23.637978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:23.638458 [info ] [MainThread]: 
[0m19:07:23.638872 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:07:23.639521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8af20>]}
[0m19:07:23.639828 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:13:52.849296 | 6c814495-8db9-4291-af78-736d54878b25 ==============================
[0m19:13:52.849296 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:13:52.854275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:13:52.854546 [debug] [MainThread]: Tracking: tracking
[0m19:13:52.854898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a323730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a321de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a320e50>]}
[0m19:13:52.925418 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:13:52.960651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:52.960949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:52.961527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:13:52.969366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afefe50>]}
[0m19:13:52.980045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abe2ce0>]}
[0m19:13:52.980430 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:13:52.980737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861ada0>]}
[0m19:13:52.982750 [info ] [MainThread]: 
[0m19:13:52.984903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:52.986730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:13:53.001684 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:13:53.002031 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:13:53.002261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:54.392979 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:13:54.396671 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:13:54.677644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:13:54.704041 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:13:54.704615 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:13:54.704981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:55.637872 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1 seconds
[0m19:13:55.653400 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:13:55.869687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0331f0>]}
[0m19:13:55.871238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:55.871855 [info ] [MainThread]: 
[0m19:13:55.885511 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.886403 [info ] [Thread-1 (]: 1 of 9 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:13:55.887513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:13:55.888033 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.897467 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.899433 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:13:55.888306 => 2023-07-08 19:13:55.899078
[0m19:13:55.900158 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:55.984741 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.990887 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:13:55.991483 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:13:55.991777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:56.747110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:56.774679 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:13:55.900468 => 2023-07-08 19:13:56.774627
[0m19:13:56.774990 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:13:56.947535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7760>]}
[0m19:13:56.948326 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.06s]
[0m19:13:56.950882 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:13:56.951547 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.952012 [info ] [Thread-1 (]: 2 of 9 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:13:56.953136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:13:56.953390 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.955127 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.955654 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:13:56.953534 => 2023-07-08 19:13:56.955602
[0m19:13:56.955850 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:56.961156 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.962291 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:13:56.962532 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:13:56.962720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.930014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:57.933862 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:13:56.955976 => 2023-07-08 19:13:57.933776
[0m19:13:57.934371 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:13:58.195073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b341c90>]}
[0m19:13:58.195892 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.24s]
[0m19:13:58.196467 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:13:58.196932 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.197493 [info ] [Thread-1 (]: 3 of 9 START sql view model DBT_NDW.price_buckets_days_on_market ............... [RUN]
[0m19:13:58.198455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:13:58.198832 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.202350 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.203333 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:13:58.199050 => 2023-07-08 19:13:58.203250
[0m19:13:58.203846 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:58.208598 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.210615 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:13:58.210968 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market)
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:13:58.211154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.921785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ad7ec1-0504-a396-0050-3987000b609e
[0m19:13:58.922150 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m19:13:58.922469 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:13:58.204173 => 2023-07-08 19:13:58.922414
[0m19:13:58.922702 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:13:59.081137 [debug] [Thread-1 (]: Database Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m19:13:59.081908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b310490>]}
[0m19:13:59.082512 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model DBT_NDW.price_buckets_days_on_market ...... [[31mERROR[0m in 0.88s]
[0m19:13:59.083253 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:13:59.083697 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.084368 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:13:59.085350 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:13:59.085719 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.102837 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.104183 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:13:59.085939 => 2023-07-08 19:13:59.104082
[0m19:13:59.104632 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:13:59.126631 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.127810 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:13:59.128057 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:13:59.128253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:59.987539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:13:59.999037 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:13:59.104806 => 2023-07-08 19:13:59.998963
[0m19:13:59.999361 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:14:00.239845 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 1.15s]
[0m19:14:00.240287 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:14:00.240540 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.240715 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:14:00.241601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:14:00.242033 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.248590 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.249226 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:14:00.242262 => 2023-07-08 19:14:00.249171
[0m19:14:00.249446 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:00.253035 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.254250 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:14:00.254457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:14:00.254636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:00.847832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:00.849924 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:14:00.249581 => 2023-07-08 19:14:00.849862
[0m19:14:00.850200 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:14:01.057830 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.82s]
[0m19:14:01.058706 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:14:01.059882 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.060398 [info ] [Thread-1 (]: 6 of 9 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:14:01.061069 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:14:01.061390 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.064596 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.065508 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:14:01.061541 => 2023-07-08 19:14:01.065349
[0m19:14:01.066116 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:01.075133 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.079456 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:14:01.079907 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:14:01.080168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:01.827409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:01.831039 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:14:01.066621 => 2023-07-08 19:14:01.830951
[0m19:14:01.831510 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:14:02.091185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c814495-8db9-4291-af78-736d54878b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7550>]}
[0m19:14:02.091995 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 1.03s]
[0m19:14:02.092586 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:14:02.093669 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.094116 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:14:02.095125 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:14:02.095560 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.102040 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.104057 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:14:02.095827 => 2023-07-08 19:14:02.103139
[0m19:14:02.104341 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:02.107253 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.108449 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:14:02.108682 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:14:02.108869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:03.453120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:03.456025 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:14:02.104502 => 2023-07-08 19:14:03.455929
[0m19:14:03.456421 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:14:03.820093 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.73s]
[0m19:14:03.820650 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:14:03.821000 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.821193 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:14:03.821822 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:14:03.822039 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.825911 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.826466 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:14:03.822178 => 2023-07-08 19:14:03.826418
[0m19:14:03.826672 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:03.829091 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.829962 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:14:03.830131 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:14:03.830281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:04.973121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:14:05.009993 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:14:03.826803 => 2023-07-08 19:14:05.009576
[0m19:14:05.010719 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:14:05.415355 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.59s]
[0m19:14:05.416413 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:14:05.417152 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.418505 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:14:05.419995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:14:05.420887 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.443664 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.449055 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:14:05.426131 => 2023-07-08 19:14:05.448953
[0m19:14:05.449602 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:05.460792 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.463951 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:14:05.464672 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:14:05.465273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:07.043155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m19:14:07.059987 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:14:05.449768 => 2023-07-08 19:14:07.058950
[0m19:14:07.061122 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:14:07.325028 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.90s]
[0m19:14:07.326281 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:14:07.335269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:07.335873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:07.336029 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:14:07.336730 [info ] [MainThread]: 
[0m19:14:07.346948 [info ] [MainThread]: Finished running 4 view models, 5 tests in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m19:14:07.348232 [debug] [MainThread]: Command end result
[0m19:14:07.378930 [info ] [MainThread]: 
[0m19:14:07.379903 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:14:07.386351 [info ] [MainThread]: 
[0m19:14:07.386594 [error] [MainThread]: [33mDatabase Error in model price_buckets_days_on_market (models/marts/core/price_buckets_days_on_market.sql)[0m
[0m19:14:07.387504 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m19:14:07.388314 [error] [MainThread]:   Missing column specification
[0m19:14:07.388770 [error] [MainThread]:   compiled Code at target/run/real_estate_dbt_project/models/marts/core/price_buckets_days_on_market.sql
[0m19:14:07.389326 [info ] [MainThread]: 
[0m19:14:07.389806 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:14:07.400065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4edb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e7550>]}
[0m19:14:07.401141 [debug] [MainThread]: Flushing usage events


============================== 2023-07-08 19:15:15.308861 | db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d ==============================
[0m19:15:15.308861 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:15:15.312856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/nathanwessel/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'full_refresh': True, 'which': 'build', 'rpc_method': 'build'}
[0m19:15:15.313120 [debug] [MainThread]: Tracking: tracking
[0m19:15:15.313525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b4310>]}
[0m19:15:15.387595 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:15:15.426944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:15.427245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:15.427860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.real_estate_dbt_project.example
[0m19:15:15.434690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11501be20>]}
[0m19:15:15.447268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11437acb0>]}
[0m19:15:15.447772 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 420 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:15:15.448097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e01e70>]}
[0m19:15:15.449739 [info ] [MainThread]: 
[0m19:15:15.453018 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:15.458779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m19:15:15.483817 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m19:15:15.484915 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m19:15:15.485255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:16.853086 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m19:15:16.854793 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m19:15:17.120310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_DBT_NDW'
[0m19:15:17.130720 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_DBT_NDW"
[0m19:15:17.131100 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "connection_name": "list_ANALYTICS_DBT_NDW"} */
show terse objects in ANALYTICS.DBT_NDW
[0m19:15:17.131322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:18.083057 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1 seconds
[0m19:15:18.085689 [debug] [ThreadPool]: On list_ANALYTICS_DBT_NDW: Close
[0m19:15:18.269568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11505c1c0>]}
[0m19:15:18.270208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:18.270471 [info ] [MainThread]: 
[0m19:15:18.275642 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.276045 [info ] [Thread-1 (]: 1 of 9 START sql view model DBT_NDW.distinct_num_baths_per_iteration ........... [RUN]
[0m19:15:18.276963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_baths_per_iteration'
[0m19:15:18.277411 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.279558 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.280351 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (compile): 2023-07-08 19:15:18.277668 => 2023-07-08 19:15:18.280280
[0m19:15:18.280606 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:18.312809 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.313998 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_baths_per_iteration"
[0m19:15:18.314212 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_baths_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_baths_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bathrooms
select distinct iteration_date, num_bathrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bathrooms
order by iteration_date asc, num_bathrooms asc
  );
[0m19:15:18.314560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:19.173332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:19.194684 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_baths_per_iteration (execute): 2023-07-08 19:15:18.280763 => 2023-07-08 19:15:19.194632
[0m19:15:19.194986 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_baths_per_iteration: Close
[0m19:15:19.501266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a113c0>]}
[0m19:15:19.502069 [info ] [Thread-1 (]: 1 of 9 OK created sql view model DBT_NDW.distinct_num_baths_per_iteration ...... [[32mSUCCESS 1[0m in 1.22s]
[0m19:15:19.504670 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_baths_per_iteration
[0m19:15:19.505911 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.506300 [info ] [Thread-1 (]: 2 of 9 START sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ........ [RUN]
[0m19:15:19.506972 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration'
[0m19:15:19.507560 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.510456 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.511569 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (compile): 2023-07-08 19:15:19.507738 => 2023-07-08 19:15:19.511475
[0m19:15:19.511983 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:19.517591 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.518750 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"
[0m19:15:19.518963 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration"} */
create or replace   view ANALYTICS.DBT_NDW.distinct_num_bedrooms_per_iteration
  
   as (
    -- for this iteration_date, show the count of each distinct number of bedrooms
select distinct iteration_date, num_bedrooms, count(*) as count
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, num_bedrooms
order by iteration_date asc, num_bedrooms asc
  );
[0m19:15:19.519142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:20.435511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:20.439044 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration (execute): 2023-07-08 19:15:19.512269 => 2023-07-08 19:15:20.438964
[0m19:15:20.439474 [debug] [Thread-1 (]: On model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration: Close
[0m19:15:20.741183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114379f60>]}
[0m19:15:20.741986 [info ] [Thread-1 (]: 2 of 9 OK created sql view model DBT_NDW.distinct_num_bedrooms_per_iteration ... [[32mSUCCESS 1[0m in 1.23s]
[0m19:15:20.742511 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.distinct_num_bedrooms_per_iteration
[0m19:15:20.742937 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.743502 [info ] [Thread-1 (]: 3 of 9 START sql view model DBT_NDW.price_buckets_days_on_market ............... [RUN]
[0m19:15:20.744538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.price_buckets_days_on_market'
[0m19:15:20.744979 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.748000 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.748678 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (compile): 2023-07-08 19:15:20.745314 => 2023-07-08 19:15:20.748616
[0m19:15:20.748936 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:20.754710 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.756514 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.price_buckets_days_on_market"
[0m19:15:20.756716 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.price_buckets_days_on_market"} */
create or replace   view ANALYTICS.DBT_NDW.price_buckets_days_on_market
  
   as (
    -- for this iteration_date, show the avg number of days on the market per (pre-defined) price range
select distinct iteration_date, 
case
    when price < 200000 then 'price_below_200000'
    when price between 200000 and 230000 then '01_price_in_low_200s'
    when price between 230001 and 250000 then '02_price_between_230001_250000'
    when price between 250001 and 260000 then '03_price_in_250s'
    when price between 260001 and 270000 then '04_price_in_260s'
    when price between 270001 and 280000 then '05_price_in_270s'
    when price between 280001 and 290000 then '06_price_in_280s'
    when price between 290001 and 300000 then '07_price_in_280s'
    when price between 300001 and 310000 then '08_price_in_300-310s'
    when price between 310001 and 310000 then '09_price_in_310s'
    ELSE 'price_above_310'
end as price_bucket,
avg(days_on_market) as avg_days_on_market
from analytics.dbt_ndw.stg_property_sale_listings
group by iteration_date, price_bucket
order by iteration_date asc, price_bucket asc
  );
[0m19:15:20.756894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:21.567769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:21.571052 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.price_buckets_days_on_market (execute): 2023-07-08 19:15:20.749093 => 2023-07-08 19:15:21.570972
[0m19:15:21.571466 [debug] [Thread-1 (]: On model.real_estate_dbt_project.price_buckets_days_on_market: Close
[0m19:15:21.746454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a6d540>]}
[0m19:15:21.747059 [info ] [Thread-1 (]: 3 of 9 OK created sql view model DBT_NDW.price_buckets_days_on_market .......... [[32mSUCCESS 1[0m in 1.00s]
[0m19:15:21.747423 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.price_buckets_days_on_market
[0m19:15:21.747990 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.748384 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [RUN]
[0m19:15:21.749016 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab'
[0m19:15:21.749662 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.768606 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.769372 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (compile): 2023-07-08 19:15:21.749809 => 2023-07-08 19:15:21.769225
[0m19:15:21.770136 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:21.792597 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.793672 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"
[0m19:15:21.793886 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_EMITTED_AT
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_EMITTED_AT is null



      
    ) dbt_internal_test
[0m19:15:21.794071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.388233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:22.395467 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab (execute): 2023-07-08 19:15:21.770331 => 2023-07-08 19:15:22.395397
[0m19:15:22.395767 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab: Close
[0m19:15:22.566004 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT  [[32mPASS[0m in 0.82s]
[0m19:15:22.566748 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_EMITTED_AT.bc4832cfab
[0m19:15:22.567265 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.567700 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [RUN]
[0m19:15:22.568396 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46'
[0m19:15:22.568679 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.577374 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.578164 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (compile): 2023-07-08 19:15:22.568849 => 2023-07-08 19:15:22.578042
[0m19:15:22.578621 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:22.581410 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.582332 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"
[0m19:15:22.582525 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID
from raw.realty_mole_property_api.property_sale_listings
where _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID is null



      
    ) dbt_internal_test
[0m19:15:22.582720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.311496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:23.313301 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46 (execute): 2023-07-08 19:15:22.578855 => 2023-07-08 19:15:23.313249
[0m19:15:23.313516 [debug] [Thread-1 (]: On test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46: Close
[0m19:15:23.476080 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID  [[32mPASS[0m in 0.91s]
[0m19:15:23.476829 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.source_not_null_realty_mole_property_api_property_sale_listings__AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID.b2bae4aa46
[0m19:15:23.477822 [debug] [Thread-1 (]: Began running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.478422 [info ] [Thread-1 (]: 6 of 9 START sql view model DBT_NDW.stg_property_sale_listings ................. [RUN]
[0m19:15:23.479464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_dbt_project.stg_property_sale_listings'
[0m19:15:23.479809 [debug] [Thread-1 (]: Began compiling node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.482900 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.484031 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (compile): 2023-07-08 19:15:23.480140 => 2023-07-08 19:15:23.483883
[0m19:15:23.484764 [debug] [Thread-1 (]: Began executing node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:23.488337 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.489481 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_dbt_project.stg_property_sale_listings"
[0m19:15:23.489653 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "model.real_estate_dbt_project.stg_property_sale_listings"} */
create or replace   view ANALYTICS.DBT_NDW.stg_property_sale_listings
  
   as (
    -- change this to select just the columns
-- you are interested in (done), and convert the timestamp to a date (done)
-- select distinct _AIRBYTE_EMITTED_AT, _AIRBYTE_PROPERTY_SALE_LISTINGS_HASHID,
-- other columns.
-- - after that is working, do the surrogate key stuff in the model (done)
-- - then add definitions and tests to the silver model (done)
-- - START BACK HERE: then make a gold table
-- - then call it done
-- then add a rentals stream
-- then add a silver and gold table for that
-- then create a simple streamlit app that shows the end table
-- then add it to linkedin
-- then call it done

select date(_airbyte_emitted_at)||'_'||id as addr_iteration_date_id,
-- convert timestamp to date
-- iteration_date: the day this data was ingested into the raw database schema
date(_airbyte_emitted_at) as iteration_date,
-- address of the home in id form
id,
-- convert timestamp to date
date(listeddate) as listed_date,
formattedaddress as formatted_address,
bathrooms as num_bathrooms,
bedrooms as num_bedrooms,
daysonmarket as days_on_market,
price

from raw.realty_mole_property_api.property_sale_listings
  );
[0m19:15:23.489805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:24.217053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:24.223569 [debug] [Thread-1 (]: Timing info for model.real_estate_dbt_project.stg_property_sale_listings (execute): 2023-07-08 19:15:23.485069 => 2023-07-08 19:15:24.223510
[0m19:15:24.223925 [debug] [Thread-1 (]: On model.real_estate_dbt_project.stg_property_sale_listings: Close
[0m19:15:24.468732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db12b4fc-7e0f-47cd-a50a-eecdeb4b2d0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a38340>]}
[0m19:15:24.469938 [info ] [Thread-1 (]: 6 of 9 OK created sql view model DBT_NDW.stg_property_sale_listings ............ [[32mSUCCESS 1[0m in 0.99s]
[0m19:15:24.471585 [debug] [Thread-1 (]: Finished running node model.real_estate_dbt_project.stg_property_sale_listings
[0m19:15:24.476369 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.476985 [info ] [Thread-1 (]: 7 of 9 START test not_null_stg_property_sale_listings_addr_iteration_date_id ... [RUN]
[0m19:15:24.477954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16'
[0m19:15:24.478400 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.487473 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.488126 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (compile): 2023-07-08 19:15:24.478654 => 2023-07-08 19:15:24.488059
[0m19:15:24.488806 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:24.492181 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.494146 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"
[0m19:15:24.494688 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addr_iteration_date_id
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is null



      
    ) dbt_internal_test
[0m19:15:24.495364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:25.383888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:25.388805 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16 (execute): 2023-07-08 19:15:24.489041 => 2023-07-08 19:15:25.388656
[0m19:15:25.389434 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16: Close
[0m19:15:25.722289 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stg_property_sale_listings_addr_iteration_date_id ......... [[32mPASS[0m in 1.24s]
[0m19:15:25.723084 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_addr_iteration_date_id.c69be7dc16
[0m19:15:25.723624 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.724308 [info ] [Thread-1 (]: 8 of 9 START test not_null_stg_property_sale_listings_iteration_date ........... [RUN]
[0m19:15:25.725452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2'
[0m19:15:25.725895 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.731499 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.732085 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (compile): 2023-07-08 19:15:25.726138 => 2023-07-08 19:15:25.732034
[0m19:15:25.732290 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:25.734725 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.735544 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"
[0m19:15:25.735706 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select iteration_date
from ANALYTICS.DBT_NDW.stg_property_sale_listings
where iteration_date is null



      
    ) dbt_internal_test
[0m19:15:25.735854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:27.055950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:27.061037 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2 (execute): 2023-07-08 19:15:25.732421 => 2023-07-08 19:15:27.060719
[0m19:15:27.061613 [debug] [Thread-1 (]: On test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2: Close
[0m19:15:27.410609 [info ] [Thread-1 (]: 8 of 9 PASS not_null_stg_property_sale_listings_iteration_date ................. [[32mPASS[0m in 1.69s]
[0m19:15:27.411440 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.not_null_stg_property_sale_listings_iteration_date.81736a01e2
[0m19:15:27.411997 [debug] [Thread-1 (]: Began running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.413146 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_property_sale_listings_addr_iteration_date_id ..... [RUN]
[0m19:15:27.414006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453'
[0m19:15:27.414261 [debug] [Thread-1 (]: Began compiling node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.427995 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.429406 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (compile): 2023-07-08 19:15:27.414423 => 2023-07-08 19:15:27.429349
[0m19:15:27.429947 [debug] [Thread-1 (]: Began executing node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:27.437757 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.439447 [debug] [Thread-1 (]: Using snowflake connection "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"
[0m19:15:27.439693 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "real_estate_dbt_project", "target_name": "dev", "node_id": "test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    addr_iteration_date_id as unique_field,
    count(*) as n_records

from ANALYTICS.DBT_NDW.stg_property_sale_listings
where addr_iteration_date_id is not null
group by addr_iteration_date_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:15:27.439938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:28.484268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m19:15:28.487939 [debug] [Thread-1 (]: Timing info for test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453 (execute): 2023-07-08 19:15:27.430161 => 2023-07-08 19:15:28.487814
[0m19:15:28.488457 [debug] [Thread-1 (]: On test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453: Close
[0m19:15:28.659914 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_property_sale_listings_addr_iteration_date_id ........... [[32mPASS[0m in 1.25s]
[0m19:15:28.660467 [debug] [Thread-1 (]: Finished running node test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453
[0m19:15:28.662385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:28.663211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:28.663503 [debug] [MainThread]: Connection 'test.real_estate_dbt_project.unique_stg_property_sale_listings_addr_iteration_date_id.b329218453' was properly closed.
[0m19:15:28.663851 [info ] [MainThread]: 
[0m19:15:28.664578 [info ] [MainThread]: Finished running 4 view models, 5 tests in 0 hours 0 minutes and 13.21 seconds (13.21s).
[0m19:15:28.666189 [debug] [MainThread]: Command end result
[0m19:15:28.704056 [info ] [MainThread]: 
[0m19:15:28.706214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:28.706513 [info ] [MainThread]: 
[0m19:15:28.706752 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:15:28.707149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b19e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11505b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ab6da0>]}
[0m19:15:28.707456 [debug] [MainThread]: Flushing usage events
